{"version":"NotebookV1","origId":2846415707863980,"name":"BB2_Usecase2_DSL_SQL","language":"python","commands":[{"version":"CommandV1","origId":8978227545991951,"guid":"8670d261-afd0-4745-99d7-12f0f77f7764","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n##**1. Data Munging** -","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"81ca9127-636a-4be2-ad66-6af734d83aa7"},{"version":"CommandV1","origId":4579324839887361,"guid":"72e301bd-ea73-4e91-a477-18ee109a48dd","subtype":"command","commandType":"auto","position":16.25,"command":"%md\n##6. Data Persistance (LOAD)-> Data Publishing & Consumption<br>\n\nStore the inner joined, lookup and enrichment, Schema Modeling, windowing, analytical functions, set operations, grouping and aggregation data into the delta tables.","commandVersion":22,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"4fbdbf31-7a73-44f2-8e74-6c6fcf35d916"},{"version":"CommandV1","origId":8978227545991955,"guid":"1878e77d-6b82-436f-a6d2-429055a8f915","subtype":"command","commandType":"auto","position":2.75,"command":"%md\n###**b. Active Data Munging** File: logistics_source1 and logistics_source2","commandVersion":4,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c81fc736-6e9f-4093-9f40-8e047989b602"},{"version":"CommandV1","origId":8978227545991958,"guid":"c64fe0f4-a301-429f-af3a-c4c5a9fd7a2f","subtype":"command","commandType":"auto","position":5.75,"command":"%md\n#####2. Cleansing, Scrubbing: \nCleansing (removal of unwanted datasets)<br>\n1. Mandatory Column Check - Drop any record where any of the following columns is NULL:shipment_id, role<br>\n2. Name Completeness Rule - Drop records where both of the following columns are NULL: first_name, last_name<br>\n3. Join Readiness Rule - Drop records where the join key is null: shipment_id<br>\n\nScrubbing (convert raw to tidy)<br>\n4. Age Defaulting Rule - Fill NULL values in the age column with: -1<br>\n5. Vehicle Type Default Rule - Fill NULL values in the vehicle_type column with: UNKNOWN<br>\n6. Invalid Age Replacement - Replace the following values in age:\n\"ten\" to -1\n\"\" to -1<br>\n7. Vehicle Type Normalization - Replace inconsistent vehicle types: \ntruck to LMV\nbike to TwoWheeler","commandVersion":78,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"628e4769-0e24-481b-8b5c-33204a91ed3c"},{"version":"CommandV1","origId":8978227545991954,"guid":"03ae253b-7507-44f8-8085-e481d822cf92","subtype":"command","commandType":"auto","position":1.25,"command":"#Create a Spark Session Object","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"13f97700-cae1-4ab6-97e8-502ffbd1a6d6"},{"version":"CommandV1","origId":4938806563024813,"guid":"fc063280-efca-461b-b530-73d3ac437ae6","subtype":"command","commandType":"auto","position":8.75,"command":"%md\nDeduplication:\n1. Apply Record Level De-Duplication\n2. Apply Column Level De-Duplication (Primary Key Enforcement)","commandVersion":8,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"5bafa5c8-7355-4d4f-9caf-40e0e0d303f0"},{"version":"CommandV1","origId":4938806563024819,"guid":"1d433dac-319b-489b-8296-bb0803baa7e5","subtype":"command","commandType":"auto","position":10.25,"command":"%md\n##### Splitting & Merging/Melting of Columns\n*Reshaping columns to extract hidden values or combine fields for better analysis.*<br>\nSource File: DF of logistics_shipment_detail_3000.json<br>\n**1. Splitting (Extraction)**\n*Breaking one column into multiple to isolate key information.*\n* **Split Order Code:**\n  * **Action:** Split `order_id` (\"ORD100000\") into two new columns:\n    * `order_prefix` (\"ORD\")\n    * `order_sequence` (\"100000\")\n* **Split Date:**\n  * **Action:** Split `shipment_date` into three separate columns for partitioning:\n    * `ship_year` (2024)\n    * `ship_month` (4)\n    * `ship_day` (23)\n\n**2. Merging (Concatenation)**\n*Combining multiple columns into a single unique identifier or description.*\n* **Create Route ID:**\n  * **Action:** Merge `source_city` (\"Chennai\") and `destination_city` (\"Pune\") to create a descriptive route key:\n    * `route_lane` (\"Chennai->Pune\")","commandVersion":19,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"7682d4f7-a188-4f86-b60f-c1afa5db220f"},{"version":"CommandV1","origId":7324207048181321,"guid":"c7e3b8b3-9993-4c74-9797-dc7fc2e3ce9c","subtype":"command","commandType":"auto","position":12.25,"command":"%md\n## 3. Data Customization & Processing - Application of Tailored Business Specific Rules\n\n### **UDF1: Complex Incentive Calculation**\n**Scenario:** The Logistics Head wants to calculate a \"Performance Bonus\" for drivers based on tenure and role complexity.\n\n**Action:** Create a Python function `calculate_bonus(role, age)` and register it as a Spark UDF.\n\n**Logic:**\n* **IF** `Role` == 'Driver' **AND** `Age` > 50:\n  * `Bonus` = 15% of Salary (Reward for Seniority)\n* **IF** `Role` == 'Driver' **AND** `Age` < 30:\n  * `Bonus` = 5% of Salary (Encouragement for Juniors)\n* **ELSE**:\n  * `Bonus` = 0\n\n**Result:** A new derived column `projected_bonus` is generated for every row in the dataset.\n\n---\n\n### **UDF2: PII Masking (Privacy Compliance)**\n**Scenario:** For the analytics dashboard, we must hide the full identity of the staff to comply with privacy laws (GDPR/DPDP), while keeping names recognizable for internal managers.\n\n**Business Rule:** Show the first 2 letters, mask the middle characters with `****`, and show the last letter.\n\n**Action:** Create a UDF `mask_identity(name)`.\n\n**Example:**\n* **Input:** `\"Rajesh\"`\n* **Output:** `\"Ra****h\"`\n<br>\n**Note: Convert the above udf logic to inbult function based transformation to ensure the performance is improved.**","commandVersion":26,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"b3a4891e-0c24-40b4-8ed8-b124efed02f8"},{"version":"CommandV1","origId":8978227545991957,"guid":"7add0f62-ab41-4fc8-a64e-627e9a345907","subtype":"command","commandType":"auto","position":4.75,"command":"%md\n#####1.Combining Data + Schema Merging (Structuring)\n1. Read both files without enforcing schema\n2. Align them into a single canonical schema: shipment_id,\nfirst_name,\nlast_name,\nage,\nrole,\nhub_location,\nvehicle_type,\ndata_source\n3. Add data_source column with values as: system1, system2 in the respective dataframes","commandVersion":25,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c7b773a5-b1db-4b1f-bf3e-93067d0483ba"},{"version":"CommandV1","origId":8978227545991953,"guid":"6a00dd82-2861-4fb9-a511-0bfa2ceb3e92","subtype":"command","commandType":"auto","position":0.4375,"command":"%md\n####2. Programatically try to find couple of data patterns applying below EDA (File: logistics_source1)\n1. Apply inferSchema and toDF to create a DF and analyse the actual data.\n2. Analyse the schema, datatypes, columns etc.,\n3. Analyse the duplicate records count and summary of the dataframe.","commandVersion":29,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"507bfd1d-8d3d-417b-8da8-074150a9eec3"},{"version":"CommandV1","origId":8980319818326194,"guid":"cf7ef727-00a9-422c-889d-454d12a4c3e1","subtype":"command","commandType":"auto","position":7.75,"command":"%md\nStandardizations:<br>\n\n1. Add a column<br> \nSource File: DF of logistics_shipment_detail_3000.json<br>: domain as 'Logistics',  current timestamp 'ingestion_timestamp' and 'False' as 'is_expedited'\n2. Column Uniformity: \nrole - Convert to lowercase<br>\nSource File: DF of merged(logistics_source1 & logistics_source2)<br>\nvehicle_type - Convert values to UPPERCASE<br>\nSource Files: DF of logistics_shipment_detail_3000.json\nhub_location - Convert values to initcap case<br>\nSource Files: DF of merged(logistics_source1 & logistics_source2)<br>\n3. Format Standardization:<br>\nSource Files: DF of logistics_shipment_detail_3000.json<br>\nConvert shipment_date to yyyy-MM-dd<br>\nEnsure shipment_cost has 2 decimal precision<br>\n4. Data Type Standardization<br>\nStandardizing column data types to fix schema drift and enable mathematical operations.<br>\nSource File: DF of merged(logistics_source1 & logistics_source2) <br>\nage: Cast String to Integer<br>\nSource File: DF of logistics_shipment_detail_3000.json<br>\nshipment_weight_kg: Cast to Double<br>\nSource File: DF of logistics_shipment_detail_3000.json<br>\nis_expedited: Cast to Boolean<br>\n5. Naming Standardization <br>\nSource File: DF of merged(logistics_source1 & logistics_source2)<br>\nRename: first_name to staff_first_name<br>\nRename: last_name to staff_last_name<br>\nRename: hub_location to origin_hub_city<br>\n6. Reordering columns logically in a better standard format:<br>\nSource File: DF of Data from all 3 files<br>\nshipment_id (Identifier), staff_first_name (Dimension)staff_last_name (Dimension), role (Dimension), origin_hub_city (Location), shipment_cost (Metric), ingestion_timestamp (Audit)","commandVersion":164,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"2cd9b438-99be-431d-a81a-493c23b2b998"},{"version":"CommandV1","origId":4579324839887362,"guid":"b8365a76-1127-478c-bbdb-d4e71c721e69","subtype":"command","commandType":"auto","position":7.25,"command":"%md\nCreating shipments Details data Dataframe creation <br>\n1. Create a DF by Reading Data from logistics_shipment_detail.json\n2. As this data is a clean json data, it doesn't require any cleansing or scrubbing.","commandVersion":27,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"ccc60af7-9398-4de0-93ce-1f5bf9dd5c47"},{"version":"CommandV1","origId":7946188265985587,"guid":"a747fec7-ccfc-4cda-97e5-abd651967c2d","subtype":"command","commandType":"auto","position":0.21875,"command":"%md\nDownload the data from the below gdrive and upload into the catalog\nhttps://drive.google.com/drive/folders/1J3AVJIPLP7CzT15yJIpSiWXshu1iLXKn?usp=drive_link","commandVersion":8,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c798b032-39ac-4bf6-9992-78159146fb4b"},{"version":"CommandV1","origId":7946188265985584,"guid":"96a229c1-e2d6-4033-a502-16888c747fa6","subtype":"command","commandType":"auto","position":0.125,"command":"%md\n#Enterprise Fleet Analytics Pipeline: Focuses on the business outcome (analytics) and the domain (fleet/logistics).","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c4e9db29-71e6-4ee6-a139-a2e6adafec63"},{"version":"CommandV1","origId":7324207048181324,"guid":"15ee779c-69da-41cc-98d1-a32f0ac01078","subtype":"command","commandType":"auto","position":15.25,"command":"%md\n## 5. Data Wrangling - Transformation & Analytics\n*Combining, modeling, and analyzing data to answer complex business questions.*\n\n### **1. Joins**\nSource Files:<br>\nLeft Side (staff_df):<br> DF of logistics_source1 & logistics_source2<br>\nRight Side (shipments_df):<br> DF of logistics_shipment_detail_3000.json<br>\n#### **1.1 Frequently Used Simple Joins (Inner, Left)**\n* **Inner Join (Performance Analysis):**\n  * **Scenario:** We only want to analyze *completed work*. Connect Staff to the Shipments they handled.\n  * **Action:** Join `staff_df` and `shipments_df` on `shipment_id`.\n  * **Result:** Returns only rows where a staff member is assigned to a valid shipment.\n* **Left Join (Idle Resource check):**\n  * **Scenario:** Find out which staff members are currently *idle* (not assigned to any shipment).\n  * **Action:** Join `staff_df` (Left) with `shipments_df` (Right) on `shipment_id`. Filter where `shipments_df.shipment_id` is NULL.\n\n#### **1.2 Infrequent Simple Joins (Self, Right, Full, Cartesian)**\n* **Self Join (Peer Finding):**\n  * **Scenario:** Find all pairs of employees working in the same `hub_location`.\n  * **Action:** Join `staff_df` to itself on `hub_location`, filtering where `staff_id_A != staff_id_B`.\n* **Right Join (Orphan Data Check):**\n  * **Scenario:** Identify shipments in the system that have *no valid driver* assigned (Data Integrity Issue).\n  * **Action:** Join `staff_df` (Left) with `shipments_df` (Right). Focus on NULLs on the left side.\n* **Full Outer Join (Reconciliation):**\n  * **Scenario:** A complete audit to find *both* idle drivers AND unassigned shipments in one view.\n  * **Action:** Perform a Full Outer Join on `shipment_id`.\n* **Cartesian/Cross Join (Capacity Planning):**\n  * **Scenario:** Generate a schedule of *every possible* driver assignment to *every* pending shipment to run an optimization algorithm.\n  * **Action:** Cross Join `drivers_df` and `pending_shipments_df`.\n\n#### **1.3 Advanced Joins (Semi and Anti)**\n* **Left Semi Join (Existence Check):**\n  * **Scenario:** \"Show me the details of Drivers who have *at least one* shipment.\" (Standard filtering).\n  * **Action:** `staff_df.join(shipments_df, \"shipment_id\", \"left_semi\")`.\n  * **Benefit:** Performance optimization; it stops scanning the right table once a match is found.\n* **Left Anti Join (Negation Check):**\n  * **Scenario:** \"Show me the details of Drivers who have *never* touched a shipment.\"\n  * **Action:** `staff_df.join(shipments_df, \"shipment_id\", \"left_anti\")`.\n\n### **2. Lookup**<br>\nSource File: DF of logistics_source1 and logistics_source2 (merged into Staff DF) and Master_City_List.csv<br>\n* **Scenario:** Validation. Check if the `hub_location` in the staff file exists in the dataframe of corporate `Master_City_List.csv`.\n* **Action:** Compare values against this Master_City_List list.\n\n### **3. Lookup & Enrichment**<br>\nSource File: DF of logistics_source1 and logistics_source2 (merged into Staff DF) and Master_City_List.csv dataframe<br>\n* **Scenario:** Geo-Tagging.\n* **Action:** Lookup `hub_location` (eg. \"Pune\") in a Master Latitude/Longitude Master_City_List.csv dataframe and enrich our logistics_source (merged dataframe) by adding `lat` and `long` columns for map plotting.\n\n### **4. Schema Modeling (Denormalization)**<br>\nSource Files: DF of All 3 Files (logistics_source1, logistics_source2, logistics_shipment_detail_3000.json)<br>\n* **Scenario:** Creating a \"Gold Layer\" Table for PowerBI/Tableau.\n* **Action:** Flatten the Star Schema. Join `Staff`, `Shipments`, and `Vehicle_Master` into one wide table (`wide_shipment_history`) so analysts don't have to perform joins during reporting.\n\n### **5. Windowing (Ranking & Trends)**<br>\nSource Files:<br>\nDF of logistics_source2: Provides hub_location (Partition Key).<br>\nlogistics_shipment_detail_3000.json: Provides shipment_cost (Ordering Key)<br>\n* **Scenario:** \"Who are the Top 3 Drivers by Cost in *each* Hub?\"\n* **Action:**\n  1. Partition by `hub_location`.\n  2. Order by `total_shipment_cost` Descending.\n  3. Apply `dense_rank()` and `row_number()\n  4. Filter where `rank or row_number <= 3`.\n\n### **6. Analytical Functions (Lead/Lag)**<br>\nSource File: <br>\nDF of logistics_shipment_detail_3000.json<br>\n* **Scenario:** Idle Time Analysis.\n* **Action:** For each driver, calculate the days elapsed since their *previous* shipment.\n\n### **7. Set Operations**<br>\nSource Files: DF of logistics_source1 and logistics_source2<br>\n* **Union:** Combining `Source1` (Legacy) and `Source2` (Modern) into one dataset (Already done in Active Munging).\n* **Intersect:** Identifying Staff IDs that appear in *both* Source 1 and Source 2 (Duplicate/Migration Check).\n* **Except (Difference):** Identifying Staff IDs present in Source 2 but *missing* from Source 1 (New Hires).\n\n### **8. Grouping & Aggregations (Advanced)**<br>\nSource Files:<br>\nDF of logistics_source2: Provides hub_location and vehicle_type (Grouping Dimensions).<br>\nDF of logistics_shipment_detail_3000.json: Provides shipment_cost (Aggregation Metric).<br>\n* **Scenario:** The CFO wants a subtotal report at multiple levels:\n  1. Total Cost by Hub.\n  2. Total Cost by Hub AND Vehicle Type.\n  3. Grand Total.\n* **Action:** Use `cube(\"hub_location\", \"vehicle_type\")` or `rollup()` to generate all these subtotals in a single query.","commandVersion":120,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f9992924-2d11-4cfa-b8fa-5c96bf6d0475"},{"version":"CommandV1","origId":7946188265985576,"guid":"714dc5da-3adb-4912-bbdd-41bc434a228d","subtype":"command","commandType":"auto","position":17.25,"command":"%md\n##7.Take the copy of the above notebook and try to write the equivalent SQL for which ever applicable.","commandVersion":10,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"aee7e8d0-1fbb-4a6c-af39-316374a94a67"},{"version":"CommandV1","origId":7946188265985586,"guid":"95f4d696-7c54-4280-a7ef-0b22c2a4a9ea","subtype":"command","commandType":"auto","position":0.1875,"command":"%md\n![logistics](logistics_project.png)","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"60102b53-da15-4c74-a306-b675d15c78d8"},{"version":"CommandV1","origId":8978227545991952,"guid":"1de2c512-2bcb-478a-a47c-d4f3bcd3ef9b","subtype":"command","commandType":"auto","position":0.375,"command":"%md\n####1. Visibily/Manually opening the file and capture couple of data patterns (Manual Exploratory Data Analysis)","commandVersion":4,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"73641445-2b65-4138-89f3-44e10449c278"},{"version":"CommandV1","origId":7324207048181323,"guid":"27e5d138-d97d-4564-93cd-a131ae0a9fea","subtype":"command","commandType":"auto","position":14.25,"command":"%md\n## 4. Data Core Curation & Processing (Pre-Wrangling)\n*Applying business logic to focus, filter, and summarize data before final analysis.*\n\n**1. Select (Projection)**<br>\nSource Files: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** The Driver App team only needs location data, not sensitive HR info.\n* **Action:** Select only `first_name`, `role`, and `hub_location`.\n\n**2. Filter (Selection)**<br>\nSource File: DF of json<br>\n* **Scenario:** We need a report on active operational problems.\n* **Action:** Filter rows where `shipment_status` is **'DELAYED'** or **'RETURNED'**.\n* **Scenario:** Insurance audit for senior staff.\n* **Action:** Filter rows where `age > 50`.\n\n**3. Derive Flags & Columns (Business Logic)**<br>\nSource File: DF of json<br>\n* **Scenario:** Identify high-value shipments for security tracking.\n* **Action:** Create flag `is_high_value` = **True** if `shipment_cost > 50,000`.\n* **Scenario:** Flag weekend operations for overtime calculation.\n* **Action:** Create flag `is_weekend` = **True** if day is Saturday or Sunday.\n\n**4. Format (Standardization)**<br>\nSource File: DF of json<br>\n* **Scenario:** Finance requires readable currency formats.\n* **Action:** Format `shipment_cost` to string like **\"₹30,695.80\"**.\n* **Scenario:** Standardize city names for reporting.\n* **Action:** Format `source_city` to Uppercase (e.g., \"chennai\" → **\"CHENNAI\"**).\n\n**5. Group & Aggregate (Summarization)**<br>\nSource Files: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** Regional staffing analysis.\n* **Action:** Group by `hub_location` and **Count** the number of staff.\n* **Scenario:** Fleet capacity analysis.\n* **Action:** Group by `vehicle_type` and **Sum** the `shipment_weight_kg`.\n\n**6. Sorting (Ordering)**<br>\nSource File: DF of json<br>\n* **Scenario:** Prioritize the most expensive shipments.\n* **Action:** Sort by `shipment_cost` in **Descending** order.\n* **Scenario:** Organize daily dispatch schedule.\n* **Action:** Sort by `shipment_date` (Ascending).\n\n**7. Limit (Top-N Analysis)**<br>\nSource File: DF of json<br>\n* **Scenario:** Dashboard snapshot of critical delays.\n* **Action:** Filter for 'DELAYED', Sort by Cost, and **Limit to top 10** rows.","commandVersion":40,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"8ed3d160-f54e-4bf3-bb2c-40ae7ff1b7d0"},{"version":"CommandV1","origId":8978227545991959,"guid":"be1501b1-93af-48ed-98c6-ade607f57b88","subtype":"command","commandType":"auto","position":6.75,"command":"%md\n####3. Standardization, De-Duplication and Replacement / Deletion of Data to make it in a usable format","commandVersion":8,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"5b089e58-4b74-41e5-b050-bbfa8d249467"},{"version":"CommandV1","origId":8978227545991950,"guid":"66aac68f-d19d-4192-83c1-75d70c099712","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n###a. Passive Data Munging -  (File: logistics_source1  and logistics_source2)\nWithout modifying the data, identify:<br>\nShipment IDs that appear in both master_v1 and master_v2<br>\nRecords where:<br>\n1. shipment_id is non-numeric\n2. age is not an integer<br>\n\nCount rows having:\n3. fewer columns than expected\n4. more columns than expected","commandVersion":25,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"de27b31f-de9a-457b-be06-00ada4960419"},{"version":"CommandV1","origId":4938806563024814,"guid":"00f061e5-1400-4b74-ba4e-5d564777f0d2","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n##2. Data Enrichment - Detailing of data\nMakes your data rich and detailed <br>","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"184ecd12-8081-4c8d-925e-d47c84e520d8"},{"version":"CommandV1","origId":4938806563024815,"guid":"fcf5de17-2b80-451b-b17e-85abff257bca","subtype":"command","commandType":"auto","position":9.25,"command":"%md\n###### Adding of Columns (Data Enrichment)\n*Creating new derived attributes to enhance traceability and analytical capability.*\n\n**1. Add Audit Timestamp (`load_dt`)**\nSource File: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** We need to track exactly when this record was ingested into our Data Lakehouse for auditing purposes.\n* **Action:** Add a column `load_dt` using the function `current_timestamp()`.\n\n**2. Create Full Name (`full_name`)**\nSource File: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** The reporting dashboard requires a single field for the driver's name instead of separate columns.\n* **Action:** Create `full_name` by concatenating `first_name` and `last_name` with a space separator.\n* **Result:** \"Rajesh\" + \" \" + \"Kumar\" -> **\"Rajesh Kumar\"**\n\n**3. Define Route Segment (`route_segment`)**\nSource File: DF of logistics_shipment_detail_3000.json<br>\n* **Scenario:** The logistics team wants to analyze performance based on specific transport lanes (Source to Destination).\n* **Action:** Combine `source_city` and `destination_city` with a hyphen.\n* **Result:** \"Chennai\" + \"-\" + \"Pune\" -> **\"Chennai-Pune\"**\n\n**4. Generate Vehicle Identifier (`vehicle_identifier`)**\nSource File: DF of logistics_shipment_detail_3000.json<br>\n* **Scenario:** We need a unique tracking code that immediately tells us the vehicle type and the shipment ID.\n* **Action:** Combine `vehicle_type` and `shipment_id` to create a composite key.\n* **Result:** \"Truck\" + \"_\" + \"500001\" -> **\"Truck_500001\"**","commandVersion":25,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"311d404f-b7d4-4e56-9f09-9367ec05e283"},{"version":"CommandV1","origId":4938806563024816,"guid":"0af56948-1126-4b86-befd-18a31db7eeca","subtype":"command","commandType":"auto","position":9.5,"command":"%md\n###### Deriving of Columns (Time Intelligence)\n*Extracting temporal features from dates to enable period-based analysis and reporting.*<br>\nSource File: logistics_shipment_detail_3000.json<br>\n**1. Derive Shipment Year (`shipment_year`)**\n* **Scenario:** Management needs an annual performance report to compare growth year-over-year.\n* **Action:** Extract the year component from `shipment_date`.\n* **Result:** \"2024-04-23\" -> **2024**\n\n**2. Derive Shipment Month (`shipment_month`)**\n* **Scenario:** Analysts want to identify seasonal peaks (e.g., increased volume in December).\n* **Action:** Extract the month component from `shipment_date`.\n* **Result:** \"2024-04-23\" -> **4** (April)\n\n**3. Flag Weekend Operations (`is_weekend`)**\n* **Scenario:** The Operations team needs to track shipments handled during weekends to calculate overtime pay or analyze non-business day capacity.\n* **Action:** Flag as **'True'** if the `shipment_date` falls on a Saturday or Sunday.\n\n**4. Flag shipment status (`is_expedited`)**\n* **Scenario:** The Operations team needs to track shipments is IN_TRANSIT or DELIVERED.\n* **Action:** Flag as **'True'** if the `shipment_status` IN_TRANSIT or DELIVERED.","commandVersion":25,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"1e525645-18d1-4a16-9909-afc89a2ed57d"},{"version":"CommandV1","origId":4938806563024817,"guid":"90f85326-5b6b-442b-9e93-3a219ac13481","subtype":"command","commandType":"auto","position":9.75,"command":"%md\n###### Enrichment/Business Logics (Calculated Fields)\n*Deriving new metrics and financial indicators using mathematical and date-based operations.*<br>\nSource File: logistics_shipment_detail_3000.json<br>\n\n**1. Calculate Unit Cost (`cost_per_kg`)**\n* **Scenario:** The Finance team wants to analyze the efficiency of shipments by determining the cost incurred per unit of weight.\n* **Action:** Divide `shipment_cost` by `shipment_weight_kg`.\n* **Logic:** `shipment_cost / shipment_weight_kg`\n\n**2. Track Shipment Age (`days_since_shipment`)**\n* **Scenario:** The Operations team needs to monitor how long it has been since a shipment was dispatched to identify potential delays.\n* **Action:** Calculate the difference in days between the `current_date` and the `shipment_date`.\n* **Logic:** `datediff(current_date(), shipment_date)`\n\n**3. Compute Tax Liability (`tax_amount`)**\n* **Scenario:** For invoicing and compliance, we must calculate the Goods and Services Tax (GST) applicable to each shipment.\n* **Action:** Calculate 18% GST on the total `shipment_cost`.\n* **Logic:** `shipment_cost * 0.18`","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f178441f-3675-448e-b8f1-f45336851f82"},{"version":"CommandV1","origId":4938806563024818,"guid":"c396dd99-0e8f-4b02-b370-e73e76ba4cd2","subtype":"command","commandType":"auto","position":10.0,"command":"%md\n###### Remove/Eliminate (drop, select, selectExpr)\n*Excluding unnecessary or redundant columns to optimize storage and privacy.*<br>\nSource File: DF of logistics_source1 and logistics_source2<br>\n\n**1. Remove Redundant Name Columns**\n* **Scenario:** Since we have already created the `full_name` column in the Enrichment step, the individual name columns are now redundant and clutter the dataset.\n* **Action:** Drop the `first_name` and `last_name` columns.\n* **Logic:** `df.drop(\"first_name\", \"last_name\")`","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"9de85d4f-d903-46fd-b110-1476a2383d6b"}],"dashboards":[],"guid":"b6afd17d-80f4-42eb-b568-2eb928b01c57","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"JUPYTER","environmentMetadata":{"client":"4","base_environment":""},"computePreferences":null,"inputWidgetPreferences":null,"environmentSerializationPreferences":null}