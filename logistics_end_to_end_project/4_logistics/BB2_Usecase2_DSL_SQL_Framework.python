{"version":"NotebookV1","origId":618645015236356,"name":"BB2_Usecase2_DSL_SQL_Framework","language":"python","commands":[{"version":"CommandV1","origId":5259768903453012,"guid":"1aeba977-634f-4301-b367-20c8289ee226","subtype":"command","commandType":"auto","position":0.248046875,"command":"def read_csv_df(spark,path,header=True,infer_schema=True,sep=\",\"):\n    return (spark.read\n        .option(\"header\", header)\n        .option(\"inferSchema\", infer_schema)\n        .option(\"sep\", sep)\n        .csv(path))","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768461751344,"submitTime":1768461750552,"finishTime":1768461751553,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"644674d7-b8b6-4526-96eb-1a8d8848b925"},{"version":"CommandV1","origId":5327682515067418,"guid":"337c4d90-6d11-4b43-bd17-3125e12d18bf","subtype":"command","commandType":"auto","position":5.25,"command":"sourcedf1=read_csv_df(spark,'/Volumes/workspace/default/volume1/logistics_source1',True,False)\nsourcedf1=sourcedf1.where(\"shipment_id!='ten'\")\ndatasourceDF1=add_literal_columns(sourcedf1,['source_system'],default_value='system1')\n#datasourceDF1.show(2)\nsourcedf2=read_csv_df(spark,'/Volumes/workspace/default/volume1/logistics_source2',True,False)\nsourcedf2=sourcedf2.where(\"shipment_id!='ten'\")\ndatasourceDF2=add_literal_columns(sourcedf2,['source_system'],default_value='system2')\nsourcedffinal=mergeDf(datasourceDF1,datasourceDF2)\nsourcedffinal.where(\"source_system='system1'\").show(2)\nsourcedffinal.where(\"source_system='system2'\").show(2)","commandVersion":69,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+-----------+----------+---------+---+----------+-------------+------------+------------+\n|shipment_id|first_name|last_name|age|      role|source_system|hub_location|vehicle_type|\n+-----------+----------+---------+---+----------+-------------+------------+------------+\n|    5000001|    Rajesh|    Kumar| 35|    Driver|      system1|        NULL|        NULL|\n|    5000002|     Anita|   Sharma| 29|Dispatcher|      system1|        NULL|        NULL|\n+-----------+----------+---------+---+----------+-------------+------------+------------+\nonly showing top 2 rows\n+-----------+----------+---------+---+----------+-------------+------------+------------+\n|shipment_id|first_name|last_name|age|      role|source_system|hub_location|vehicle_type|\n+-----------+----------+---------+---+----------+-------------+------------+------------+\n|    6000001|    Rajesh|    Kumar| 35|    Driver|      system2|   Bangalore|       Truck|\n|    6000002|     Anita|   Sharma| 29|Dispatcher|      system2|     Chennai|         Van|\n+-----------+----------+---------+---+----------+-------------+------------+------------+\nonly showing top 2 rows\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"sourcedf1","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"age","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"datasourceDF1","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"age","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"source_system","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"sourcedf2","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"age","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"hub_location","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"datasourceDF2","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"age","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"hub_location","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"},{"metadata":{},"name":"source_system","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"sourcedffinal","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"age","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"source_system","nullable":false,"type":"string"},{"metadata":{},"name":"hub_location","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":["\u001B[0;31m---------------------------------------------------------------------------\u001B[0m","\u001B[0;31mNameError\u001B[0m                                 Traceback (most recent call last)","File \u001B[0;32m<command-5327682515067418>, line 3\u001B[0m\n\u001B[1;32m      1\u001B[0m sourcedf1\u001B[38;5;241m=\u001B[39mread_csv_df(spark,\u001B[38;5;124m'\u001B[39m\u001B[38;5;124m/Volumes/workspace/default/volume1/logistics_source1\u001B[39m\u001B[38;5;124m'\u001B[39m,\u001B[38;5;28;01mTrue\u001B[39;00m,\u001B[38;5;28;01mFalse\u001B[39;00m)\n\u001B[1;32m      2\u001B[0m sourcedf1\u001B[38;5;241m=\u001B[39msourcedf1\u001B[38;5;241m.\u001B[39mwhere(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mshipment_id!=\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124mten\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124m\"\u001B[39m)\n\u001B[0;32m----> 3\u001B[0m datasourceDF1\u001B[38;5;241m=\u001B[39madd_literal_columns(sourcedffinal,[\u001B[38;5;124m'\u001B[39m\u001B[38;5;124msource_system\u001B[39m\u001B[38;5;124m'\u001B[39m],default_value\u001B[38;5;241m=\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124msystem1\u001B[39m\u001B[38;5;124m'\u001B[39m)\n\u001B[1;32m      4\u001B[0m sourcedffinal\u001B[38;5;241m.\u001B[39mshow(\u001B[38;5;241m2\u001B[39m)\n\u001B[1;32m      5\u001B[0m sourcedf2\u001B[38;5;241m=\u001B[39mread_csv_df(spark,\u001B[38;5;124m'\u001B[39m\u001B[38;5;124m/Volumes/workspace/default/volume1/logistics_source2\u001B[39m\u001B[38;5;124m'\u001B[39m,\u001B[38;5;28;01mTrue\u001B[39;00m,\u001B[38;5;28;01mFalse\u001B[39;00m)\n","\u001B[0;31mNameError\u001B[0m: name 'add_literal_columns' is not defined"],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":{"ename":"NameError","evalue":"name 'add_literal_columns' is not defined"},"sqlProps":{"sqlState":"KAN00","errorClass":"NOTEBOOK_USER_ERROR","stackTrace":null,"startIndex":null,"stopIndex":null,"pysparkCallSite":null,"pysparkFragment":null,"pysparkSummary":null,"breakingChangeInfo":null}},"workflows":[],"startTime":1768461752664,"submitTime":1768461750600,"finishTime":1768461794844,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",1128]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"a7323aa8-6eb4-4a93-a122-691d5f10ef3e"},{"version":"CommandV1","origId":5259768903453010,"guid":"e0878b5b-6cf7-4849-acaf-fa6704215e49","subtype":"command","commandType":"auto","position":0.2421875,"command":"%md\nCommon Functions/Utilities creation","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"0328cb49-8d65-46dc-a236-95f314240bec"},{"version":"CommandV1","origId":5327682515067422,"guid":"32257189-7213-46aa-b806-6baf01e4a15a","subtype":"command","commandType":"auto","position":0.249755859375,"command":"def read_json_df(spark, path,mline=True):\n    return spark.read.json(path,multiLine=mline)","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768461752186,"submitTime":1768461750557,"finishTime":1768461752359,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f4fe8f52-8532-4468-aae2-bb76d1208a63"},{"version":"CommandV1","origId":5327682515067419,"guid":"b5c83cd2-d256-4326-9afe-ca541c695e60","subtype":"command","commandType":"auto","position":0.2490234375,"command":"def mergeDf(df1,df2,allowmissingcol=True):\n    return df1.unionByName(df2, allowMissingColumns=allowmissingcol)","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768461751577,"submitTime":1768461750553,"finishTime":1768461751876,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"40139f64-4a11-4a8a-b90e-b0034a7cd774"},{"version":"CommandV1","origId":5437246975805770,"guid":"83d1e070-0eed-4041-a8d7-0639fc353f7c","subtype":"command","commandType":"auto","position":8.625,"command":"def create_final_dataset(shipment_df, staff_df):\n    \"\"\"\n    Joins shipment and staff data, selecting specific columns in a logical order.\n    \"\"\"\n    # Join on shipment_id\n    joined_df = shipment_df.join(staff_df, on=\"shipment_id\", how=\"inner\")\n\n    # Reordering columns logically\n    return joined_df.select(\n        col(\"shipment_id\"),          # Identifier\n        col(\"staff_first_name\"),     # Dimension\n        col(\"staff_last_name\"),      # Dimension\n        col(\"role\"),                 # Dimension\n        col(\"origin_hub_city\"),      # Location\n        col(\"shipment_cost\"),        # Metric\n        col(\"ingestion_timestamp\")   # Audit\n    )","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768461800269,"submitTime":1768461750663,"finishTime":1768461800437,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"9c680dd8-571b-46e6-a176-961bd865a533"},{"version":"CommandV1","origId":5259768903453011,"guid":"c58b7f2f-3f33-454b-b9cf-c40ac14e2eb1","subtype":"command","commandType":"auto","position":0.24609375,"command":"from pyspark.sql import SparkSession\ndef get_spark_session(app_name=\"Logistics Data Engineering Project\"):\n    \"\"\"\n    Creates and returns a SparkSession.\n    Works in Databricks and non-Databricks environments.\n    \"\"\"\n    try:\n        spark = SparkSession.getActiveSession()\n        if spark:\n            return spark\n    except:\n        pass\n\n    return (SparkSession.builder.appName(app_name).getOrCreate())","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768461750922,"submitTime":1768461750550,"finishTime":1768461751267,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"93670bc0-06bf-4a6f-a0d5-7cc3fa49f641"},{"version":"CommandV1","origId":5259768903453009,"guid":"09b04c50-a72c-4aa2-9e6f-eba022dd019e","subtype":"command","commandType":"auto","position":0.234375,"command":"%md\nETL Flow Implemented\n\nRead Functions:\nread_csv_df()\nread_json_df()\n\nCleansing:\nNull handling\nDefaults for missing values\n\nEnrichment:\nLoad timestamp\nShipment year derivation\n\nIntegration:\nUnion multiple sources\nJoin staff + shipment\n\nAnalytics Ready Output:\nClean, enriched DataFrame","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"2fb4f569-1dc7-4479-968b-ed27b8c2456a"},{"version":"CommandV1","origId":618645015236357,"guid":"d03ec40b-ef78-4fc5-96b7-1bc1baca85da","subtype":"command","commandType":"auto","position":0.125,"command":"%md\n#Enterprise Fleet Analytics Pipeline: Focuses on the business outcome (analytics) and the domain (fleet/logistics).","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c4e9db29-71e6-4ee6-a139-a2e6adafec63"},{"version":"CommandV1","origId":618645015236358,"guid":"7f7af060-fdc3-4ca3-8891-4c740a8171fc","subtype":"command","commandType":"auto","position":0.1875,"command":"%md\n![logistics](logistics_project.png)","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"60102b53-da15-4c74-a306-b675d15c78d8"},{"version":"CommandV1","origId":618645015236359,"guid":"7932a2b3-b6cb-47a8-a5c6-c959eee5cd23","subtype":"command","commandType":"auto","position":0.21875,"command":"%md\nDownload the data from the below gdrive and upload into the catalog\nhttps://drive.google.com/drive/folders/1J3AVJIPLP7CzT15yJIpSiWXshu1iLXKn?usp=drive_link","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c798b032-39ac-4bf6-9992-78159146fb4b"},{"version":"CommandV1","origId":618645015236360,"guid":"d8feac5d-cbea-459c-b780-310b41526895","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n##**1. Data Munging** -","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"81ca9127-636a-4be2-ad66-6af734d83aa7"},{"version":"CommandV1","origId":618645015236364,"guid":"044b574a-9182-4d8d-b9fe-7a0724742eae","subtype":"command","commandType":"auto","position":1.25,"command":"#Create a Spark Session Object\n#spark=SparkSession.builder.getOrCreate()\nspark=get_spark_session(\"Logistics Data Engineering Project\")\nprint(spark)","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"<pyspark.sql.connect.session.SparkSession object at 0xffee144cd550>\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":["\u001B[0;31m---------------------------------------------------------------------------\u001B[0m","\u001B[0;31mNameError\u001B[0m                                 Traceback (most recent call last)","File \u001B[0;32m<command-618645015236364>, line 2\u001B[0m\n\u001B[1;32m      1\u001B[0m \u001B[38;5;66;03m#Create a Spark Session Object\u001B[39;00m\n\u001B[0;32m----> 2\u001B[0m spark\u001B[38;5;241m=\u001B[39mget_spark_session(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mLogistics Data Engineering Project\u001B[39m\u001B[38;5;124m\"\u001B[39m)\n\u001B[1;32m      3\u001B[0m \u001B[38;5;28mprint\u001B[39m(spark)\n","\u001B[0;31mNameError\u001B[0m: name 'get_spark_session' is not defined"],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":{"ename":"NameError","evalue":"name 'get_spark_session' is not defined"},"sqlProps":{"sqlState":"KAN00","errorClass":"NOTEBOOK_USER_ERROR","stackTrace":null,"startIndex":null,"stopIndex":null,"pysparkCallSite":null,"pysparkFragment":null,"pysparkSummary":null,"breakingChangeInfo":null}},"workflows":[],"startTime":1768461752388,"submitTime":1768461750572,"finishTime":1768461752561,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",68]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"13f97700-cae1-4ab6-97e8-502ffbd1a6d6"},{"version":"CommandV1","origId":618645015236365,"guid":"11fe6d86-325c-4ced-9c11-280fe9bc33e8","subtype":"command","commandType":"auto","position":2.75,"command":"%md\n###**b. Active Data Munging** File: logistics_source1 and logistics_source2","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c81fc736-6e9f-4093-9f40-8e047989b602"},{"version":"CommandV1","origId":618645015236366,"guid":"8d88fa3d-ca84-4aee-bcec-0c66e117a649","subtype":"command","commandType":"auto","position":4.75,"command":"%md\n#####1.Combining Data + Schema Merging (Structuring)\n1. Read both files without enforcing schema\n2. Align them into a single canonical schema: shipment_id,\nfirst_name,\nlast_name,\nage,\nrole,\nhub_location,\nvehicle_type,\ndata_source\n3. Add data_source column with values as: system1, system2 in the respective dataframes","commandVersion":25,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c7b773a5-b1db-4b1f-bf3e-93067d0483ba"},{"version":"CommandV1","origId":618645015236367,"guid":"081201bf-4f45-435c-86b1-29e2663ae0d7","subtype":"command","commandType":"auto","position":5.75,"command":"%md\n#####2. Cleansing, Scrubbing: \nCleansing (removal of unwanted datasets)<br>\n1. Mandatory Column Check - Drop any record where any of the following columns is NULL:shipment_id, role<br>\n2. Name Completeness Rule - Drop records where both of the following columns are NULL: first_name, last_name<br>\n3. Join Readiness Rule - Drop records where the join key is null: shipment_id<br>\n\nScrubbing (convert raw to tidy)<br>\n4. Age Defaulting Rule - Fill NULL values in the age column with: -1<br>\n5. Vehicle Type Default Rule - Fill NULL values in the vehicle_type column with: UNKNOWN<br>\n6. Invalid Age Replacement - Replace the following values in age:\n\"ten\" to -1\n\"\" to -1<br>\n7. Vehicle Type Normalization - Replace inconsistent vehicle types: \ntruck to LMV\nbike to TwoWheeler","commandVersion":78,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"628e4769-0e24-481b-8b5c-33204a91ed3c"},{"version":"CommandV1","origId":618645015236368,"guid":"23c83b69-3c08-423c-a9ce-1cb067de4d7f","subtype":"command","commandType":"auto","position":6.75,"command":"%md\n####3. Standardization, De-Duplication and Replacement / Deletion of Data to make it in a usable format","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"5b089e58-4b74-41e5-b050-bbfa8d249467"},{"version":"CommandV1","origId":618645015236369,"guid":"091a58aa-e77c-4268-ac31-ff5e6e5520e9","subtype":"command","commandType":"auto","position":7.25,"command":"%md\nCreating shipments Details data Dataframe creation <br>\n1. Create a DF by Reading Data from logistics_shipment_detail.json\n2. As this data is a clean json data, it doesn't require any cleansing or scrubbing.","commandVersion":27,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"ccc60af7-9398-4de0-93ce-1f5bf9dd5c47"},{"version":"CommandV1","origId":618645015236370,"guid":"02a073aa-10f6-4ec9-8932-0a95562ecfe6","subtype":"command","commandType":"auto","position":7.75,"command":"%md\nStandardizations:<br>\n\n1. Add a column<br> \nSource File: DF of logistics_shipment_detail_3000.json<br>: domain as 'Logistics',  current timestamp 'ingestion_timestamp' and 'False' as 'is_expedited'\n2. Column Uniformity: \nrole - Convert to lowercase<br>\nSource File: DF of merged(logistics_source1 & logistics_source2)<br>\nvehicle_type - Convert values to UPPERCASE<br>\nSource Files: DF of logistics_shipment_detail_3000.json\nhub_location - Convert values to initcap case<br>\nSource Files: DF of merged(logistics_source1 & logistics_source2)<br>\n3. Format Standardization:<br>\nSource Files: DF of logistics_shipment_detail_3000.json<br>\nConvert shipment_date to yyyy-MM-dd<br>\nEnsure shipment_cost has 2 decimal precision<br>\n4. Data Type Standardization<br>\nStandardizing column data types to fix schema drift and enable mathematical operations.<br>\nSource File: DF of merged(logistics_source1 & logistics_source2) <br>\nage: Cast String to Integer<br>\nSource File: DF of logistics_shipment_detail_3000.json<br>\nshipment_weight_kg: Cast to Double<br>\nSource File: DF of logistics_shipment_detail_3000.json<br>\nis_expedited: Cast to Boolean<br>\n5. Naming Standardization <br>\nSource File: DF of merged(logistics_source1 & logistics_source2)<br>\nRename: first_name to staff_first_name<br>\nRename: last_name to staff_last_name<br>\nRename: hub_location to origin_hub_city<br>\n6. Reordering columns logically in a better standard format:<br>\nSource File: DF of Data from all 3 files<br>\nshipment_id (Identifier), staff_first_name (Dimension)staff_last_name (Dimension), role (Dimension), origin_hub_city (Location), shipment_cost (Metric), ingestion_timestamp (Audit)","commandVersion":164,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"2cd9b438-99be-431d-a81a-493c23b2b998"},{"version":"CommandV1","origId":618645015236371,"guid":"1a525f82-6f53-4044-93fe-49bed21d16f6","subtype":"command","commandType":"auto","position":8.75,"command":"%md\nDeduplication:\n1. Apply Record Level De-Duplication\n2. Apply Column Level De-Duplication (Primary Key Enforcement)","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"5bafa5c8-7355-4d4f-9caf-40e0e0d303f0"},{"version":"CommandV1","origId":618645015236372,"guid":"a06f4c29-cfad-4140-97ae-0ffe09e7bfd3","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n##2. Data Enrichment - Detailing of data\nMakes your data rich and detailed <br>","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"184ecd12-8081-4c8d-925e-d47c84e520d8"},{"version":"CommandV1","origId":618645015236373,"guid":"79b058ae-3358-46bd-8d2b-327d85e82fc7","subtype":"command","commandType":"auto","position":9.25,"command":"%md\n###### Adding of Columns (Data Enrichment)\n*Creating new derived attributes to enhance traceability and analytical capability.*\n\n**1. Add Audit Timestamp (`load_dt`)**\nSource File: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** We need to track exactly when this record was ingested into our Data Lakehouse for auditing purposes.\n* **Action:** Add a column `load_dt` using the function `current_timestamp()`.\n\n**2. Create Full Name (`full_name`)**\nSource File: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** The reporting dashboard requires a single field for the driver's name instead of separate columns.\n* **Action:** Create `full_name` by concatenating `first_name` and `last_name` with a space separator.\n* **Result:** \"Rajesh\" + \" \" + \"Kumar\" -> **\"Rajesh Kumar\"**\n\n**3. Define Route Segment (`route_segment`)**\nSource File: DF of logistics_shipment_detail_3000.json<br>\n* **Scenario:** The logistics team wants to analyze performance based on specific transport lanes (Source to Destination).\n* **Action:** Combine `source_city` and `destination_city` with a hyphen.\n* **Result:** \"Chennai\" + \"-\" + \"Pune\" -> **\"Chennai-Pune\"**\n\n**4. Generate Vehicle Identifier (`vehicle_identifier`)**\nSource File: DF of logistics_shipment_detail_3000.json<br>\n* **Scenario:** We need a unique tracking code that immediately tells us the vehicle type and the shipment ID.\n* **Action:** Combine `vehicle_type` and `shipment_id` to create a composite key.\n* **Result:** \"Truck\" + \"_\" + \"500001\" -> **\"Truck_500001\"**","commandVersion":25,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"311d404f-b7d4-4e56-9f09-9367ec05e283"},{"version":"CommandV1","origId":618645015236374,"guid":"ed420acf-dbff-4baa-9e44-39aa3e7ddbd2","subtype":"command","commandType":"auto","position":9.5,"command":"%md\n###### Deriving of Columns (Time Intelligence)\n*Extracting temporal features from dates to enable period-based analysis and reporting.*<br>\nSource File: logistics_shipment_detail_3000.json<br>\n**1. Derive Shipment Year (`shipment_year`)**\n* **Scenario:** Management needs an annual performance report to compare growth year-over-year.\n* **Action:** Extract the year component from `shipment_date`.\n* **Result:** \"2024-04-23\" -> **2024**\n\n**2. Derive Shipment Month (`shipment_month`)**\n* **Scenario:** Analysts want to identify seasonal peaks (e.g., increased volume in December).\n* **Action:** Extract the month component from `shipment_date`.\n* **Result:** \"2024-04-23\" -> **4** (April)\n\n**3. Flag Weekend Operations (`is_weekend`)**\n* **Scenario:** The Operations team needs to track shipments handled during weekends to calculate overtime pay or analyze non-business day capacity.\n* **Action:** Flag as **'True'** if the `shipment_date` falls on a Saturday or Sunday.\n\n**4. Flag shipment status (`is_expedited`)**\n* **Scenario:** The Operations team needs to track shipments is IN_TRANSIT or DELIVERED.\n* **Action:** Flag as **'True'** if the `shipment_status` IN_TRANSIT or DELIVERED.","commandVersion":25,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"1e525645-18d1-4a16-9909-afc89a2ed57d"},{"version":"CommandV1","origId":618645015236375,"guid":"3831b72e-9d18-45ef-9f9d-5a16b32c6114","subtype":"command","commandType":"auto","position":9.75,"command":"%md\n###### Enrichment/Business Logics (Calculated Fields)\n*Deriving new metrics and financial indicators using mathematical and date-based operations.*<br>\nSource File: logistics_shipment_detail_3000.json<br>\n\n**1. Calculate Unit Cost (`cost_per_kg`)**\n* **Scenario:** The Finance team wants to analyze the efficiency of shipments by determining the cost incurred per unit of weight.\n* **Action:** Divide `shipment_cost` by `shipment_weight_kg`.\n* **Logic:** `shipment_cost / shipment_weight_kg`\n\n**2. Track Shipment Age (`days_since_shipment`)**\n* **Scenario:** The Operations team needs to monitor how long it has been since a shipment was dispatched to identify potential delays.\n* **Action:** Calculate the difference in days between the `current_date` and the `shipment_date`.\n* **Logic:** `datediff(current_date(), shipment_date)`\n\n**3. Compute Tax Liability (`tax_amount`)**\n* **Scenario:** For invoicing and compliance, we must calculate the Goods and Services Tax (GST) applicable to each shipment.\n* **Action:** Calculate 18% GST on the total `shipment_cost`.\n* **Logic:** `shipment_cost * 0.18`","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f178441f-3675-448e-b8f1-f45336851f82"},{"version":"CommandV1","origId":618645015236376,"guid":"3d5d80b4-2f56-436c-8278-284971347592","subtype":"command","commandType":"auto","position":10.0,"command":"%md\n###### Remove/Eliminate (drop, select, selectExpr)\n*Excluding unnecessary or redundant columns to optimize storage and privacy.*<br>\nSource File: DF of logistics_source1 and logistics_source2<br>\n\n**1. Remove Redundant Name Columns**\n* **Scenario:** Since we have already created the `full_name` column in the Enrichment step, the individual name columns are now redundant and clutter the dataset.\n* **Action:** Drop the `first_name` and `last_name` columns.\n* **Logic:** `df.drop(\"first_name\", \"last_name\")`","commandVersion":8,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"9de85d4f-d903-46fd-b110-1476a2383d6b"},{"version":"CommandV1","origId":618645015236377,"guid":"3f21ed6c-e149-4761-b09a-7c0efe6b54c9","subtype":"command","commandType":"auto","position":10.25,"command":"%md\n##### Splitting & Merging/Melting of Columns\n*Reshaping columns to extract hidden values or combine fields for better analysis.*<br>\nSource File: DF of logistics_shipment_detail_3000.json<br>\n**1. Splitting (Extraction)**\n*Breaking one column into multiple to isolate key information.*\n* **Split Order Code:**\n  * **Action:** Split `order_id` (\"ORD100000\") into two new columns:\n    * `order_prefix` (\"ORD\")\n    * `order_sequence` (\"100000\")\n* **Split Date:**\n  * **Action:** Split `shipment_date` into three separate columns for partitioning:\n    * `ship_year` (2024)\n    * `ship_month` (4)\n    * `ship_day` (23)\n\n**2. Merging (Concatenation)**\n*Combining multiple columns into a single unique identifier or description.*\n* **Create Route ID:**\n  * **Action:** Merge `source_city` (\"Chennai\") and `destination_city` (\"Pune\") to create a descriptive route key:\n    * `route_lane` (\"Chennai->Pune\")","commandVersion":19,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"7682d4f7-a188-4f86-b60f-c1afa5db220f"},{"version":"CommandV1","origId":618645015236378,"guid":"2514a826-e1b4-48b1-a2f9-49f05bfd0857","subtype":"command","commandType":"auto","position":12.25,"command":"%md\n## 3. Data Customization & Processing - Application of Tailored Business Specific Rules\n\n### **UDF1: Complex Incentive Calculation**\n**Scenario:** The Logistics Head wants to calculate a \"Performance Bonus\" for drivers based on tenure and role complexity.\n\n**Action:** Create a Python function `calculate_bonus(role, age)` and register it as a Spark UDF.\n\n**Logic:**\n* **IF** `Role` == 'Driver' **AND** `Age` > 50:\n  * `Bonus` = 15% of Salary (Reward for Seniority)\n* **IF** `Role` == 'Driver' **AND** `Age` < 30:\n  * `Bonus` = 5% of Salary (Encouragement for Juniors)\n* **ELSE**:\n  * `Bonus` = 0\n\n**Result:** A new derived column `projected_bonus` is generated for every row in the dataset.\n\n---\n\n### **UDF2: PII Masking (Privacy Compliance)**\n**Scenario:** For the analytics dashboard, we must hide the full identity of the staff to comply with privacy laws (GDPR/DPDP), while keeping names recognizable for internal managers.\n\n**Business Rule:** Show the first 2 letters, mask the middle characters with `****`, and show the last letter.\n\n**Action:** Create a UDF `mask_identity(name)`.\n\n**Example:**\n* **Input:** `\"Rajesh\"`\n* **Output:** `\"Ra****h\"`\n<br>\n**Note: Convert the above udf logic to inbult function based transformation to ensure the performance is improved.**","commandVersion":26,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"b3a4891e-0c24-40b4-8ed8-b124efed02f8"},{"version":"CommandV1","origId":618645015236379,"guid":"780e42d2-505c-462c-9885-ef898c4abb86","subtype":"command","commandType":"auto","position":14.25,"command":"%md\n## 4. Data Core Curation & Processing (Pre-Wrangling)\n*Applying business logic to focus, filter, and summarize data before final analysis.*\n\n**1. Select (Projection)**<br>\nSource Files: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** The Driver App team only needs location data, not sensitive HR info.\n* **Action:** Select only `first_name`, `role`, and `hub_location`.\n\n**2. Filter (Selection)**<br>\nSource File: DF of json<br>\n* **Scenario:** We need a report on active operational problems.\n* **Action:** Filter rows where `shipment_status` is **'DELAYED'** or **'RETURNED'**.\n* **Scenario:** Insurance audit for senior staff.\n* **Action:** Filter rows where `age > 50`.\n\n**3. Derive Flags & Columns (Business Logic)**<br>\nSource File: DF of json<br>\n* **Scenario:** Identify high-value shipments for security tracking.\n* **Action:** Create flag `is_high_value` = **True** if `shipment_cost > 50,000`.\n* **Scenario:** Flag weekend operations for overtime calculation.\n* **Action:** Create flag `is_weekend` = **True** if day is Saturday or Sunday.\n\n**4. Format (Standardization)**<br>\nSource File: DF of json<br>\n* **Scenario:** Finance requires readable currency formats.\n* **Action:** Format `shipment_cost` to string like **\"30,695.80\"**.\n* **Scenario:** Standardize city names for reporting.\n* **Action:** Format `source_city` to Uppercase (e.g., \"chennai\"  **\"CHENNAI\"**).\n\n**5. Group & Aggregate (Summarization)**<br>\nSource Files: DF of logistics_source1 and logistics_source2<br>\n* **Scenario:** Regional staffing analysis.\n* **Action:** Group by `hub_location` and **Count** the number of staff.\n* **Scenario:** Fleet capacity analysis.\n* **Action:** Group by `vehicle_type` and **Sum** the `shipment_weight_kg`.\n\n**6. Sorting (Ordering)**<br>\nSource File: DF of json<br>\n* **Scenario:** Prioritize the most expensive shipments.\n* **Action:** Sort by `shipment_cost` in **Descending** order.\n* **Scenario:** Organize daily dispatch schedule.\n* **Action:** Sort by `shipment_date` (Ascending) then `priority_flag` (Descending).\n\n**7. Limit (Top-N Analysis)**<br>\nSource File: DF of json<br>\n* **Scenario:** Dashboard snapshot of critical delays.\n* **Action:** Filter for 'DELAYED', Sort by Cost, and **Limit to top 10** rows.","commandVersion":39,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"8ed3d160-f54e-4bf3-bb2c-40ae7ff1b7d0"},{"version":"CommandV1","origId":618645015236380,"guid":"24952bef-4b9a-43a3-8689-212844a8cb00","subtype":"command","commandType":"auto","position":15.25,"command":"%md\n## 5. Data Wrangling - Transformation & Analytics\n*Combining, modeling, and analyzing data to answer complex business questions.*\n\n### **1. Joins**\nSource Files:<br>\nLeft Side (staff_df):<br> DF of logistics_source1 & logistics_source2<br>\nRight Side (shipments_df):<br> DF of logistics_shipment_detail_3000.json<br>\n#### **1.1 Frequently Used Simple Joins (Inner, Left)**\n* **Inner Join (Performance Analysis):**\n  * **Scenario:** We only want to analyze *completed work*. Connect Staff to the Shipments they handled.\n  * **Action:** Join `staff_df` and `shipments_df` on `shipment_id`.\n  * **Result:** Returns only rows where a staff member is assigned to a valid shipment.\n* **Left Join (Idle Resource check):**\n  * **Scenario:** Find out which staff members are currently *idle* (not assigned to any shipment).\n  * **Action:** Join `staff_df` (Left) with `shipments_df` (Right) on `shipment_id`. Filter where `shipments_df.shipment_id` is NULL.\n\n#### **1.2 Infrequent Simple Joins (Self, Right, Full, Cartesian)**\n* **Self Join (Peer Finding):**\n  * **Scenario:** Find all pairs of employees working in the same `hub_location`.\n  * **Action:** Join `staff_df` to itself on `hub_location`, filtering where `staff_id_A != staff_id_B`.\n* **Right Join (Orphan Data Check):**\n  * **Scenario:** Identify shipments in the system that have *no valid driver* assigned (Data Integrity Issue).\n  * **Action:** Join `staff_df` (Left) with `shipments_df` (Right). Focus on NULLs on the left side.\n* **Full Outer Join (Reconciliation):**\n  * **Scenario:** A complete audit to find *both* idle drivers AND unassigned shipments in one view.\n  * **Action:** Perform a Full Outer Join on `shipment_id`.\n* **Cartesian/Cross Join (Capacity Planning):**\n  * **Scenario:** Generate a schedule of *every possible* driver assignment to *every* pending shipment to run an optimization algorithm.\n  * **Action:** Cross Join `drivers_df` and `pending_shipments_df`.\n\n#### **1.3 Advanced Joins (Semi and Anti)**\n* **Left Semi Join (Existence Check):**\n  * **Scenario:** \"Show me the details of Drivers who have *at least one* shipment.\" (Standard filtering).\n  * **Action:** `staff_df.join(shipments_df, \"shipment_id\", \"left_semi\")`.\n  * **Benefit:** Performance optimization; it stops scanning the right table once a match is found.\n* **Left Anti Join (Negation Check):**\n  * **Scenario:** \"Show me the details of Drivers who have *never* touched a shipment.\"\n  * **Action:** `staff_df.join(shipments_df, \"shipment_id\", \"left_anti\")`.\n\n### **2. Lookup**<br>\nSource File: DF of logistics_source1 and logistics_source2 (merged into Staff DF)<br>\n* **Scenario:** Validation. Check if the `hub_location` in the staff file exists in the corporate `Master_City_List`.\n* **Action:** Compare values against a reference list.\n\n### **3. Lookup & Enrichment**<br>\nSource File: DF of logistics_source1 and logistics_source2 (merged into Staff DF)<br>\n* **Scenario:** Geo-Tagging.\n* **Action:** Lookup `hub_location` (\"Pune\") in a Master Latitude/Longitude table and enrich the dataset by adding `lat` and `long` columns for map plotting.\n\n### **4. Schema Modeling (Denormalization)**<br>\nSource Files: DF of All 3 Files (logistics_source1, logistics_source2, logistics_shipment_detail_3000.json)<br>\n* **Scenario:** Creating a \"Gold Layer\" Table for PowerBI/Tableau.\n* **Action:** Flatten the Star Schema. Join `Staff`, `Shipments`, and `Vehicle_Master` into one wide table (`wide_shipment_history`) so analysts don't have to perform joins during reporting.\n\n### **5. Windowing (Ranking & Trends)**<br>\nSource Files:<br>\nDF of logistics_source2: Provides hub_location (Partition Key).<br>\nlogistics_shipment_detail_3000.json: Provides shipment_cost (Ordering Key)<br>\n* **Scenario:** \"Who are the Top 3 Drivers by Cost in *each* Hub?\"\n* **Action:**\n  1. Partition by `hub_location`.\n  2. Order by `total_shipment_cost` Descending.\n  3. Apply `dense_rank()` and `row_number()\n  4. Filter where `rank or row_number <= 3`.\n\n### **6. Analytical Functions (Lead/Lag)**<br>\nSource File: <br>\nDF of logistics_shipment_detail_3000.json<br>\n* **Scenario:** Idle Time Analysis.\n* **Action:** For each driver, calculate the days elapsed since their *previous* shipment.\n\n### **7. Set Operations**<br>\nSource Files: DF of logistics_source1 and logistics_source2<br>\n* **Union:** Combining `Source1` (Legacy) and `Source2` (Modern) into one dataset (Already done in Active Munging).\n* **Intersect:** Identifying Staff IDs that appear in *both* Source 1 and Source 2 (Duplicate/Migration Check).\n* **Except (Difference):** Identifying Staff IDs present in Source 2 but *missing* from Source 1 (New Hires).\n\n### **8. Grouping & Aggregations (Advanced)**<br>\nSource Files:<br>\nDF of logistics_source2: Provides hub_location and vehicle_type (Grouping Dimensions).<br>\nDF of logistics_shipment_detail_3000.json: Provides shipment_cost (Aggregation Metric).<br>\n* **Scenario:** The CFO wants a subtotal report at multiple levels:\n  1. Total Cost by Hub.\n  2. Total Cost by Hub AND Vehicle Type.\n  3. Grand Total.\n* **Action:** Use `cube(\"hub_location\", \"vehicle_type\")` or `rollup()` to generate all these subtotals in a single query.","commandVersion":103,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f9992924-2d11-4cfa-b8fa-5c96bf6d0475"},{"version":"CommandV1","origId":618645015236381,"guid":"ec178e95-cbbe-4b9d-81a0-3d826b79f6e6","subtype":"command","commandType":"auto","position":16.25,"command":"%md\n##6. Data Persistance (LOAD)-> Data Publishing & Consumption<br>\n\nStore the inner joined, lookup and enrichment, Schema Modeling, windowing, analytical functions, set operations, grouping and aggregation data into the delta tables.","commandVersion":22,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"4fbdbf31-7a73-44f2-8e74-6c6fcf35d916"},{"version":"CommandV1","origId":618645015236382,"guid":"60001f71-0e90-4506-a15e-9cd31b440c47","subtype":"command","commandType":"auto","position":17.25,"command":"%md\n##7.Take the copy of the above notebook and try to write the equivalent SQL for which ever applicable.","commandVersion":10,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"aee7e8d0-1fbb-4a6c-af39-316374a94a67"},{"version":"CommandV1","origId":5327682515067423,"guid":"29e97de4-cc6c-4c1f-a8e3-9b312eb74b97","subtype":"command","commandType":"auto","position":5.5,"command":"jsondf=read_json_df(spark,'/Volumes/workspace/default/volume1/logistics_shipment_detail_3000.json',True)\njsondf.show()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+-----------+----------------+---------+------------+-------------+-------------+-----------+---------------+------------------+-----------+------------+\n| cargo_type|destination_city| order_id|payment_mode|shipment_cost|shipment_date|shipment_id|shipment_status|shipment_weight_kg|source_city|vehicle_type|\n+-----------+----------------+---------+------------+-------------+-------------+-----------+---------------+------------------+-----------+------------+\n|Electronics|            Pune|ORD100000|         COD|      30695.8|     24-04-23|    5008467|        CREATED|            476.12|    Chennai|        Bike|\n|       FMCG|       Hyderabad|ORD100001|         COD|     22687.09|     24-04-23|    5000392|        DELAYED|            165.54|       Pune|        Bike|\n|  Furniture|           Delhi|ORD100002|      CREDIT|     12472.89|     24-09-17|    5004625|        CREATED|            149.65|  Hyderabad|         Car|\n|Electronics|          Indore|ORD100003|         COD|       7231.7|     24-10-02|    5001687|        DELAYED|             106.6|      Delhi|       Truck|\n|  Furniture|            Pune|ORD100004|      CREDIT|     45683.19|     24-12-30|    5006493|     IN_TRANSIT|            812.73|       Pune|         Car|\n|     Pharma|           Kochi|ORD100005|         COD|     47510.76|     24-01-27|    5001767|      CANCELLED|            750.27|     Jaipur|         Car|\n|     Pharma|            Pune|ORD100006|         COD|     36773.68|     24-06-23|    5000812|     IN_TRANSIT|            493.16|    Chennai|         Van|\n|       FMCG|         Chennai|ORD100007|      CREDIT|     29445.23|     24-08-04|    5004507|        DELAYED|            195.97|     Jaipur|         Car|\n|       FMCG|           Delhi|ORD100008|      CREDIT|     17718.21|     24-09-15|    5003095|        CREATED|            324.67|  Bangalore|        Bike|\n| Automobile|         Chennai|ORD100009|      CREDIT|     18428.32|     24-02-10|    5009380|     IN_TRANSIT|            971.21|      Kochi|         Car|\n|       FMCG|          Indore|ORD100010|         COD|      9797.39|     24-09-22|    5001089|      CANCELLED|            829.79|     Indore|       Truck|\n| Automobile|           Delhi|ORD100011|      CREDIT|     40316.29|     24-03-10|    5005990|        CREATED|            584.01|     Indore|         Van|\n|     Pharma|            Pune|ORD100012|      CREDIT|     28686.17|     24-06-06|    5000692|      CANCELLED|            707.13|    Chennai|        Bike|\n|Electronics|          Mumbai|ORD100013|      CREDIT|      8688.54|     24-08-09|    5009212|        CREATED|             15.54|       Pune|       Truck|\n|       FMCG|          Jaipur|ORD100014|      CREDIT|     38656.79|     24-02-12|    5004257|        CREATED|            682.47|       Pune|         Car|\n| Automobile|            Pune|ORD100015|         COD|     32694.13|     24-12-07|    5000454|        CREATED|             61.17|       Pune|         Van|\n|     Pharma|           Delhi|ORD100016|         COD|     33586.29|     24-06-30|    5004931|      DELIVERED|            435.18|       Pune|        Bike|\n|Electronics|          Mumbai|ORD100017|         COD|     45177.44|     24-04-25|    5004968|      CANCELLED|            249.09|  Bangalore|        Bike|\n|       FMCG|       Hyderabad|ORD100018|         COD|     47050.87|     24-02-16|    5004728|        CREATED|            911.49|    Chennai|       Truck|\n|       FMCG|            Pune|ORD100019|     PREPAID|     38175.92|     24-11-03|    5009168|     IN_TRANSIT|            764.25|     Indore|         Van|\n+-----------+----------------+---------+------------+-------------+-------------+-----------+---------------+------------------+-----------+------------+\nonly showing top 20 rows\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"jsondf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"cargo_type","nullable":true,"type":"string"},{"metadata":{},"name":"destination_city","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"string"},{"metadata":{},"name":"payment_mode","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_date","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"shipment_status","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_weight_kg","nullable":true,"type":"double"},{"metadata":{},"name":"source_city","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":["\u001B[0;31m---------------------------------------------------------------------------\u001B[0m","\u001B[0;31mNameError\u001B[0m                                 Traceback (most recent call last)","File \u001B[0;32m<command-5327682515067423>, line 1\u001B[0m\n\u001B[0;32m----> 1\u001B[0m jsondf\u001B[38;5;241m=\u001B[39mread_json_df(spark,\u001B[38;5;124m'\u001B[39m\u001B[38;5;124m/Volumes/workspace/default/volume1/logistics_shipment_detail_3000.json\u001B[39m\u001B[38;5;124m'\u001B[39m,\u001B[38;5;28;01mTrue\u001B[39;00m)\n\u001B[1;32m      2\u001B[0m jsondf\u001B[38;5;241m.\u001B[39mshow()\n","\u001B[0;31mNameError\u001B[0m: name 'read_json_df' is not defined"],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":{"ename":"NameError","evalue":"name 'read_json_df' is not defined"},"sqlProps":{"sqlState":"KAN00","errorClass":"NOTEBOOK_USER_ERROR","stackTrace":null,"startIndex":null,"stopIndex":null,"pysparkCallSite":null,"pysparkFragment":null,"pysparkSummary":null,"breakingChangeInfo":null}},"workflows":[],"startTime":1768461794915,"submitTime":1768461750602,"finishTime":1768461797727,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",3721]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"a240778c-35fd-4212-8ca6-d5276cfb4705"},{"version":"CommandV1","origId":5437246975805775,"guid":"b68a0a6c-1a47-4610-b66e-1e3ef5ebdcb1","subtype":"command","commandType":"auto","position":8.59375,"command":"def apply_deduplication(df, primary_key_cols=None):\n    \"\"\"\n    Applies record-level and column-level (Primary Key) deduplication.\n    \"\"\"\n    # 1. Record Level (exact duplicate rows)\n    df_clean = df.dropDuplicates()\n\n    # 2. Column Level (Primary Key enforcement)\n    if primary_key_cols:\n        df_clean = df_clean.dropDuplicates(subset=primary_key_cols)\n\n    return df_clean\n\ndef create_final_dataset(shipment_df, staff_df):\n    \"\"\"\n    Joins shipment and staff data and selects final columns.\n    \"\"\"\n    # Join on shipment_id\n    joined_df = shipment_df.join(staff_df, on=\"shipment_id\", how=\"inner\")\n\n    # Reordering columns logically\n    return joined_df.select(\n        col(\"shipment_id\"),          # Identifier\n        col(\"staff_first_name\"),     # Dimension\n        col(\"staff_last_name\"),      # Dimension\n        col(\"role\"),                 # Dimension\n        col(\"origin_hub_city\"),      # Location\n        col(\"shipment_cost\"),        # Metric\n        col(\"ingestion_timestamp\")   # Audit\n    )","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"e6dbb51f-1921-4906-98fa-f80983fb1f8e"},{"version":"CommandV1","origId":5327682515067420,"guid":"1e546f3f-171b-4c84-b734-fa512debb93e","subtype":"command","commandType":"auto","position":0.24951171875,"command":"from pyspark.sql.functions import lit\ndef add_literal_columns(df, columns, default_value=None):\n    for col_name in columns:\n        df = df.withColumn(col_name, lit(default_value))\n    return df\n","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768461751916,"submitTime":1768461750555,"finishTime":1768461752157,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"cd877a4d-062e-4110-a3ff-7dfa45018c34"},{"version":"CommandV1","origId":5437246975805772,"guid":"b1f8baad-f644-4b52-ba08-10eaf533478e","subtype":"command","commandType":"auto","position":8.375,"command":"jsondf=process_shipment_details(jsondf)\njsondf.show(2)","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+-----------+----------------+---------+------------+-------------+-------------+-----------+---------------+------------------+-----------+------------+---------+--------------------+------------+\n| cargo_type|destination_city| order_id|payment_mode|shipment_cost|shipment_date|shipment_id|shipment_status|shipment_weight_kg|source_city|vehicle_type|   domain| ingestion_timestamp|is_expedited|\n+-----------+----------------+---------+------------+-------------+-------------+-----------+---------------+------------------+-----------+------------+---------+--------------------+------------+\n|Electronics|            Pune|ORD100000|         COD|      30695.8|   2024-04-23|    5008467|        CREATED|            476.12|    Chennai|        Bike|Logistics|2026-01-15 07:38:...|       false|\n|       FMCG|       Hyderabad|ORD100001|         COD|     22687.09|   2024-04-23|    5000392|        DELAYED|            165.54|       Pune|        Bike|Logistics|2026-01-15 07:38:...|       false|\n+-----------+----------------+---------+------------+-------------+-------------+-----------+---------------+------------------+-----------+------------+---------+--------------------+------------+\nonly showing top 2 rows\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"jsondf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"cargo_type","nullable":true,"type":"string"},{"metadata":{},"name":"destination_city","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"string"},{"metadata":{},"name":"payment_mode","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_date","nullable":true,"type":"date"},{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"shipment_status","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_weight_kg","nullable":true,"type":"double"},{"metadata":{},"name":"source_city","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"},{"metadata":{},"name":"domain","nullable":false,"type":"string"},{"metadata":{},"name":"ingestion_timestamp","nullable":false,"type":"timestamp"},{"metadata":{},"name":"is_expedited","nullable":true,"type":"boolean"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":["\u001B[0;31m---------------------------------------------------------------------------\u001B[0m","\u001B[0;31mNameError\u001B[0m                                 Traceback (most recent call last)","File \u001B[0;32m<command-5437246975805772>, line 1\u001B[0m\n\u001B[0;32m----> 1\u001B[0m jsondf\u001B[38;5;241m=\u001B[39mprocess_shipment_details(jsondf)\n\u001B[1;32m      2\u001B[0m jsondf\u001B[38;5;241m.\u001B[39mshow(\u001B[38;5;241m2\u001B[39m)\n","File \u001B[0;32m<command-5437246975805768>, line 9\u001B[0m, in \u001B[0;36mprocess_shipment_details\u001B[0;34m(df)\u001B[0m\n\u001B[1;32m      1\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21mprocess_shipment_details\u001B[39m(df):\n\u001B[1;32m      2\u001B[0m \u001B[38;5;250m    \u001B[39m\u001B[38;5;124;03m\"\"\"\u001B[39;00m\n\u001B[1;32m      3\u001B[0m \u001B[38;5;124;03m    Standardizes shipment details: adds columns, fixes date/cost formats, \u001B[39;00m\n\u001B[1;32m      4\u001B[0m \u001B[38;5;124;03m    and casts data types.\u001B[39;00m\n\u001B[1;32m      5\u001B[0m \u001B[38;5;124;03m    \"\"\"\u001B[39;00m\n\u001B[1;32m      6\u001B[0m     \u001B[38;5;28;01mreturn\u001B[39;00m (df\n\u001B[1;32m      7\u001B[0m         \u001B[38;5;66;03m# Add Columns\u001B[39;00m\n\u001B[1;32m      8\u001B[0m         \u001B[38;5;241m.\u001B[39mwithColumn(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdomain\u001B[39m\u001B[38;5;124m\"\u001B[39m, lit(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mLogistics\u001B[39m\u001B[38;5;124m\"\u001B[39m))\n\u001B[0;32m----> 9\u001B[0m         \u001B[38;5;241m.\u001B[39mwithColumn(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mingestion_timestamp\u001B[39m\u001B[38;5;124m\"\u001B[39m, current_timestamp())\n\u001B[1;32m     10\u001B[0m         \u001B[38;5;66;03m# Add 'False' string then cast to Boolean as requested\u001B[39;00m\n\u001B[1;32m     11\u001B[0m         \u001B[38;5;241m.\u001B[39mwithColumn(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mis_expedited\u001B[39m\u001B[38;5;124m\"\u001B[39m, lit(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mFalse\u001B[39m\u001B[38;5;124m\"\u001B[39m)\u001B[38;5;241m.\u001B[39mcast(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mboolean\u001B[39m\u001B[38;5;124m\"\u001B[39m))\n\u001B[1;32m     12\u001B[0m         \n\u001B[1;32m     13\u001B[0m         \u001B[38;5;66;03m# Format Standardization\u001B[39;00m\n\u001B[1;32m     14\u001B[0m         \u001B[38;5;66;03m# Input seems to be 'yy-MM-dd' (e.g., '24-04-23'), converting to DateType\u001B[39;00m\n\u001B[1;32m     15\u001B[0m         \u001B[38;5;241m.\u001B[39mwithColumn(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mshipment_date\u001B[39m\u001B[38;5;124m\"\u001B[39m, to_date(col(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mshipment_date\u001B[39m\u001B[38;5;124m\"\u001B[39m), \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124myy-MM-dd\u001B[39m\u001B[38;5;124m\"\u001B[39m))\n\u001B[1;32m     16\u001B[0m         \u001B[38;5;241m.\u001B[39mwithColumn(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mshipment_cost\u001B[39m\u001B[38;5;124m\"\u001B[39m, \u001B[38;5;28mround\u001B[39m(col(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mshipment_cost\u001B[39m\u001B[38;5;124m\"\u001B[39m), \u001B[38;5;241m2\u001B[39m))\n\u001B[1;32m     17\u001B[0m         \n\u001B[1;32m     18\u001B[0m         \u001B[38;5;66;03m# Data Type Standardization\u001B[39;00m\n\u001B[1;32m     19\u001B[0m         \u001B[38;5;241m.\u001B[39mwithColumn(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mshipment_weight_kg\u001B[39m\u001B[38;5;124m\"\u001B[39m, col(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mshipment_weight_kg\u001B[39m\u001B[38;5;124m\"\u001B[39m)\u001B[38;5;241m.\u001B[39mcast(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdouble\u001B[39m\u001B[38;5;124m\"\u001B[39m))\n\u001B[1;32m     20\u001B[0m     )\n","\u001B[0;31mNameError\u001B[0m: name 'current_timestamp' is not defined"],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":{"ename":"NameError","evalue":"name 'current_timestamp' is not defined"},"sqlProps":{"sqlState":"KAN00","errorClass":"NOTEBOOK_USER_ERROR","stackTrace":null,"startIndex":null,"stopIndex":null,"pysparkCallSite":null,"pysparkFragment":null,"pysparkSummary":null,"breakingChangeInfo":null}},"workflows":[],"startTime":1768462698578,"submitTime":1768462698553,"finishTime":1768462699444,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",1212]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"b28b3bb1-d343-444b-bcbd-5e4ad7af4514"},{"version":"CommandV1","origId":6632795358361798,"guid":"209801d3-923f-477e-a6c1-2134ae9697ef","subtype":"command","commandType":"auto","position":6.25,"command":"def clean_and_scrub_generic(df, drop_configs, replace_configs, fill_defaults, type_casts):\n    for subset, how_strategy in drop_configs:\n        df = df.na.drop(subset=subset, how=how_strategy)\n        \n    for replace_map, subset in replace_configs:\n        df = df.na.replace(replace_map, subset=subset)\n        \n    df = df.na.fill(fill_defaults)\n    \n    for col_name, target_type in type_casts.items():\n        df = df.withColumn(col_name, df[col_name].cast(target_type))\n            \n    return df\n\n","commandVersion":35,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":["\u001B[0;31m---------------------------------------------------------------------------\u001B[0m","\u001B[0;31mNameError\u001B[0m                                 Traceback (most recent call last)","File \u001B[0;32m<command-6632795358361798>, line 37\u001B[0m\n\u001B[1;32m     35\u001B[0m \u001B[38;5;66;03m# Calling the function\u001B[39;00m\n\u001B[1;32m     36\u001B[0m cleanse_scrub_final_df \u001B[38;5;241m=\u001B[39m clean_and_scrub_generic(sourcedffinal, drop_rules, replace_rules, fill_rules, cast_rules)\n\u001B[0;32m---> 37\u001B[0m clean_scrub_final_df\u001B[38;5;241m.\u001B[39mshow(\u001B[38;5;241m2\u001B[39m)\n","\u001B[0;31mNameError\u001B[0m: name 'clean_scrub_final_df' is not defined"],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":{"ename":"NameError","evalue":"name 'clean_scrub_final_df' is not defined"},"sqlProps":{"sqlState":"KAN00","errorClass":"NOTEBOOK_USER_ERROR","stackTrace":null,"startIndex":null,"stopIndex":null,"pysparkCallSite":null,"pysparkFragment":null,"pysparkSummary":null,"breakingChangeInfo":null}},"workflows":[],"startTime":1768461797753,"submitTime":1768461750618,"finishTime":1768461797843,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"b72ae12e-83d5-4bfb-a009-e7ba6aee6afe"},{"version":"CommandV1","origId":5437246975805768,"guid":"04a91939-61a0-4ab6-9388-ae28342bb22a","subtype":"command","commandType":"auto","position":8.25,"command":"from pyspark.sql.functions import *\ndef process_shipment_details(df):\n    \"\"\"\n    Standardizes shipment details: adds columns, fixes date/cost formats, \n    and casts data types.\n    \"\"\"\n    return (df\n        # Add Columns\n        .withColumn(\"domain\", lit(\"Logistics\"))\n        .withColumn(\"ingestion_timestamp\", current_timestamp())\n        .withColumn(\"is_expedited\", lit(\"False\").cast(\"boolean\"))\n        \n        # Format Standardization\n        .withColumn(\"shipment_date\", to_date(col(\"shipment_date\"), \"yy-MM-dd\"))\n        .withColumn(\"shipment_cost\", round(col(\"shipment_cost\"), 2))\n        \n        # Data Type Standardization\n        .withColumn(\"shipment_weight_kg\", col(\"shipment_weight_kg\").cast(\"double\"))\n    )","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768462694432,"submitTime":1768462694399,"finishTime":1768462694641,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"143080b3-e278-4326-bf31-90b4a84e672c"},{"version":"CommandV1","origId":5437246975805776,"guid":"2d211786-88b7-42f8-8f5d-be026a161fdb","subtype":"command","commandType":"auto","position":8.609375,"command":"mergeddf=apply_deduplication(mergeddf)\nmergeddf.show(2)","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"8b9b31b7-1033-4d3d-8dce-682b80f33a38"},{"version":"CommandV1","origId":5437246975805773,"guid":"0800c59c-3018-4e86-a3c1-d4344b29081f","subtype":"command","commandType":"auto","position":9.375,"command":"def process_shipment_details(df):\n    \"\"\"\n    Standardizes shipment details: adds columns, fixes date/cost formats, \n    and casts data types.\n    \"\"\"\n    return (df\n        # Add Columns\n        .withColumn(\"domain\", lit(\"Logistics\"))\n        .withColumn(\"ingestion_timestamp\", current_timestamp())\n        .withColumn(\"is_expedited\", lit(\"False\").cast(\"boolean\"))\n        \n        # Format Standardization\n        .withColumn(\"shipment_date\", to_date(col(\"shipment_date\"), \"yy-MM-dd\"))\n        .withColumn(\"shipment_cost\", round(col(\"shipment_cost\"), 2))\n        \n        # Data Type Standardization\n        .withColumn(\"shipment_weight_kg\", col(\"shipment_weight_kg\").cast(\"double\"))\n    )","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c8860482-1bf1-452d-99af-1c75b293e9d8"},{"version":"CommandV1","origId":5437246975805774,"guid":"2ebe9c6c-529f-42e6-9977-f4a2403b9a45","subtype":"command","commandType":"auto","position":8.5625,"command":"mergeddf=finalize_staff_data(cleanse_scrub_final_df)\nmergeddf.show(2)","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+-----------+----------------+---------------+---+----------+-------------+---------------+------------+\n|shipment_id|staff_first_name|staff_last_name|age|      role|source_system|origin_hub_city|vehicle_type|\n+-----------+----------------+---------------+---+----------+-------------+---------------+------------+\n|    5000001|          Rajesh|          Kumar| 35|    driver|      system1|           NULL|     UNKNOWN|\n|    5000002|           Anita|         Sharma| 29|dispatcher|      system1|           NULL|     UNKNOWN|\n+-----------+----------------+---------------+---+----------+-------------+---------------+------------+\nonly showing top 2 rows\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"mergeddf","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"string"},{"metadata":{},"name":"staff_first_name","nullable":true,"type":"string"},{"metadata":{},"name":"staff_last_name","nullable":true,"type":"string"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"source_system","nullable":false,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768462952158,"submitTime":1768462952136,"finishTime":1768462953101,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",654]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"0497ea33-6dc2-4b87-bd49-1cf43f2a916f"},{"version":"CommandV1","origId":5437246975805769,"guid":"90e7ecca-87a2-4785-aafb-83c123bbe906","subtype":"command","commandType":"auto","position":8.5,"command":"def finalize_staff_data(df):\n    \"\"\"\n    Applies final standardizations to the already merged/scrubbed staff data:\n    - Casing (Lower/Upper/Initcap)\n    - Renaming (first_name -> staff_first_name, etc)\n    \"\"\"\n    return (df\n        # Column Uniformity\n        .withColumn(\"role\", lower(col(\"role\")))\n        .withColumn(\"vehicle_type\", upper(col(\"vehicle_type\")))\n        .withColumn(\"hub_location\", initcap(col(\"hub_location\")))\n        \n        # Naming Standardization\n        .withColumnRenamed(\"first_name\", \"staff_first_name\")\n        .withColumnRenamed(\"last_name\", \"staff_last_name\")\n        .withColumnRenamed(\"hub_location\", \"origin_hub_city\")\n    )","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768462948531,"submitTime":1768462948499,"finishTime":1768462948697,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"39c4abe6-8a32-4122-87e6-7d417218f7c9"},{"version":"CommandV1","origId":6632795358361799,"guid":"6297bb81-82c5-4d56-92c7-7e7db1ec1ee6","subtype":"command","commandType":"auto","position":6.5,"command":"drop_rules = [([\"shipment_id\", \"role\"], \"any\"),([\"first_name\", \"last_name\"], \"all\")]\n\nage_map = {\"ten\": \"-1\", \"\": \"-1\", \" \": \"-1\"}\nvehicle_map = {\"truck\": \"LMV\", \"Truck\": \"LMV\", \"TRUCK\": \"LMV\",\"bike\": \"TwoWheeler\", \"Bike\": \"TwoWheeler\", \"BIKE\": \"TwoWheeler\"}\n\nreplace_rules = [(age_map, [\"age\"]),(vehicle_map, [\"vehicle_type\"])]\nfill_rules = {\"age\": \"-1\",\"vehicle_type\": \"UNKNOWN\"}\ncast_rules = {\"age\": \"int\"}\n\ncleanse_scrub_final_df = clean_and_scrub_generic(sourcedffinal, drop_rules, replace_rules, fill_rules, cast_rules)\ncleanse_scrub_final_df.show(2)","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+-----------+----------+---------+---+----------+-------------+------------+------------+\n|shipment_id|first_name|last_name|age|      role|source_system|hub_location|vehicle_type|\n+-----------+----------+---------+---+----------+-------------+------------+------------+\n|    5000001|    Rajesh|    Kumar| 35|    Driver|      system1|        NULL|     UNKNOWN|\n|    5000002|     Anita|   Sharma| 29|Dispatcher|      system1|        NULL|     UNKNOWN|\n+-----------+----------+---------+---+----------+-------------+------------+------------+\nonly showing top 2 rows\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"cleanse_scrub_final_df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"source_system","nullable":false,"type":"string"},{"metadata":{},"name":"hub_location","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768461797881,"submitTime":1768461750620,"finishTime":1768461799838,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",564]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"fece9115-0947-41b7-8cbc-0ae15ea0406d"},{"version":"CommandV1","origId":5437246975805771,"guid":"23656b1c-91ac-4500-af68-8b2a4d628fd4","subtype":"command","commandType":"auto","position":8.6875,"command":"df_shipments_processed = process_shipment_details(df_json)\ndf_staff_processed = process_staff_data(df_src1, df_src2)\n\n# 3. Create Final Output\nfinal_df = create_final_dataset(df_shipments_processed, df_staff_processed)\n\n# 4. View Result\nfinal_df.show(5)\nfinal_df.printSchema()","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"34b2f9ac-ea9b-456f-8e16-2ff6c7c228c6"}],"dashboards":[],"guid":"6732c709-60f6-4414-a9be-12d3ec069c2c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"JUPYTER","environmentMetadata":{"client":"4","base_environment":""},"computePreferences":null,"inputWidgetPreferences":null,"environmentSerializationPreferences":null}