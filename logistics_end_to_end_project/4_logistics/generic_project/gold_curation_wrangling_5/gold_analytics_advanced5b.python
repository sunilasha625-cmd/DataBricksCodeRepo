{"version":"NotebookV1","origId":3312318445443463,"name":"gold_analytics_advanced5b","language":"python","commands":[{"version":"CommandV1","origId":4921811840474317,"guid":"73f3dab8-aab2-45bd-8f97-18f2f4ed3e1e","subtype":"script","commandType":"auto","position":0.8611111111111112,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Requirement already satisfied: word2number in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9e5d385e-4ff6-4c64-847d-2ff0fa0a8c1f/lib/python3.12/site-packages (1.1)\n\u001B[43mNote: you may need to restart the kernel using %restart_python or dbutils.library.restartPython() to use updated packages.\u001B[0m\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848086158,"submitTime":0,"finishTime":1768848096207,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",293]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"091c523a-36d9-4d3e-afb9-fb90e63708f3"},{"version":"CommandV1","origId":4921811840474318,"guid":"29ffd6ee-ffca-4130-bd52-5d66c3e34686","subtype":"script","commandType":"auto","position":0.9722222222222222,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848096290,"submitTime":0,"finishTime":1768848096697,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"906a486e-d5db-4ded-85b9-fe7a51e3d0b2"},{"version":"CommandV1","origId":4921811840474319,"guid":"73c511e3-554b-44f3-b758-9d06cb21768d","subtype":"script","commandType":"auto","position":1.0833333333333333,"command":"","commandVersion":104,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848096723,"submitTime":0,"finishTime":1768848096898,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"ca134f5d-35c9-419f-8d8b-7fa1e19c3509"},{"version":"CommandV1","origId":4921811840474320,"guid":"b9a8e34d-feff-4add-a056-43b5f46f416c","subtype":"script","commandType":"auto","position":1.1944444444444444,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848096927,"submitTime":0,"finishTime":1768848097102,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"4c42bf4a-cd7e-4685-aca7-a5d7b171f822"},{"version":"CommandV1","origId":4921811840474321,"guid":"23bcc718-3025-4569-a649-59077cd6cf9c","subtype":"script","commandType":"auto","position":1.3055555555555556,"command":"","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848097139,"submitTime":0,"finishTime":1768848097308,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"342ddd87-0e33-4fb8-af94-49a5efaaddc7"},{"version":"CommandV1","origId":4921811840474322,"guid":"099f0186-569a-43c0-8112-3ed4bfd5fb9e","subtype":"script","commandType":"auto","position":1.4166666666666665,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848097343,"submitTime":0,"finishTime":1768848097506,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"6c15ae68-11f5-4ff6-a474-ea9358fa5dd2"},{"version":"CommandV1","origId":4921811840474323,"guid":"7e116bcf-66a3-4a35-964c-9ee7204acf2c","subtype":"script","commandType":"auto","position":1.5277777777777777,"command":"","commandVersion":0,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848097526,"submitTime":0,"finishTime":1768848097611,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"36ec6b70-4d7e-4ffc-a105-3a044815366f"},{"version":"CommandV1","origId":4921811840474324,"guid":"f30cc003-754a-4ebd-add1-f759f9aa0a77","subtype":"script","commandType":"auto","position":1.6388888888888888,"command":"","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848097643,"submitTime":0,"finishTime":1768848097809,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c942c703-18e0-492b-bc28-0f29fd404e89"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"a8571e16-3f59-4f75-80d9-7c1076b4a14c"},{"version":"CommandV1","origId":6358089889637121,"guid":"c942c703-18e0-492b-bc28-0f29fd404e89","subtype":"command","commandType":"auto","position":0.75,"command":"%run /Workspace/Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/general_conf_utils_1_2/util_functions2","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"Notebook not found: util_functions2. Notebooks can be specified via a relative path (./Notebook or ../folder/Notebook) or via an absolute path (/Abs/Path/to/Notebook). Make sure you are specifying the path correctly.\n\nStacktrace:\n  /Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/bronze_ingest3: python","errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848086158,"submitTime":1768848073991,"finishTime":1768848097809,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"d8ae37a3-4db7-4824-8a4b-6538e24d0366"},{"version":"CommandV1","origId":6172445262621890,"guid":"a5438720-0f94-4682-8f64-062d3fd4cd73","subtype":"command","commandType":"auto","position":0.5833333333333334,"command":"dbutils.widgets.text(\"catalog\",\"\")\nCATALOG=dbutils.widgets.get(\"catalog\").strip()\ndbutils.widgets.text(\"schema\",\"\")\nSCHEMA=dbutils.widgets.get(\"schema\").strip()","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"016f884e-9294-4b9b-aebe-c0ee1818ae07"},{"version":"CommandV1","origId":6172445262621891,"guid":"eb4994cb-9ab4-47cc-8446-eca89c994f1b","subtype":"command","commandType":"auto","position":0.6666666666666667,"command":"%python\nimport json\n\nconfig_nb_output = dbutils.notebook.run(\n    \"/Workspace/Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/general_conf_utils_1_2/configs_path1\",\n    120,{\"catalog\": CATALOG,\"schema\": SCHEMA})\n\nconfig_dict = json.loads(config_nb_output)\n\nCATALOG = config_dict[\"CATALOG\"]\nSCHEMA = config_dict[\"SCHEMA\"]\nSRC=config_dict[\"SRC\"]\nBRONZE = config_dict[\"BRONZE\"]\nSILVER = config_dict[\"SILVER\"]\nGOLD = config_dict[\"GOLD\"]\nSILVERDB = config_dict[\"SILVERDB\"]\nGOLDDB = config_dict[\"GOLDDB\"]","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"One of the commands could not be parsed","errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768746808320,"submitTime":1768746803774,"finishTime":1768746845803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"839133ad-6564-4e1b-acc3-bd15ac03b2ce"},{"version":"CommandV1","origId":6926205340395114,"guid":"793241a1-24a9-42ab-af5d-da069f1f10cf","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.window import Window\n\ndf = spark.read.format(\"delta\").load(f\"{GOLD}/core_curated\")\ndf.show()\n# TOP 3 DRIVERS BY COST PER HUB\nw = Window.partitionBy(\"origin_hub_city\") \\\n          .orderBy(F.col(\"shipment_cost\").desc())\n\ntop3 = df.withColumn(\"rank\", F.dense_rank().over(w)) \\\n         .filter(\"rank <= 3\")\n\n# LEAD / LAG\nlag_df = df.withColumn(\n    \"prev_shipment_days\",\n    F.lag(\"shipment_year\").over(\n        Window.partitionBy(\"masked_staff_name\").orderBy(\"shipment_year\")\n    )\n)\n\n# CUBE AGGREGATION\ncube_df = df.cube(\"origin_hub_city\") \\\n    .agg(F.sum(\"shipment_cost\").alias(\"total_cost\"))\n\nwrite_file(top3,f\"{GOLD}/top3_drivers\")\nwrite_file(lag_df,f\"{GOLD}/prev_shipment_days\")\nwrite_file(cube_df,f\"{GOLD}/cube_costs\")","commandVersion":27,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+-----------+-----------------+-----------+---------------+-------------+-------------+--------------+----------------+-----------+----------+--------------------+\n|shipment_id|masked_staff_name|       role|origin_hub_city|shipment_cost|shipment_year|shipment_month|   route_segment|cost_per_kg|tax_amount| ingestion_timestamp|\n+-----------+-----------------+-----------+---------------+-------------+-------------+--------------+----------------+-----------+----------+--------------------+\n|    6000009|          Si****h|     driver|         Jaipur|     11496.88|         2024|             5|Indore-Hyderabad|      20.44|   2069.44|2026-01-19 18:17:...|\n|    6000043|          Mo****r|coordinator|        Newyork|      40886.4|         2024|             3|  Indore-Chennai|      154.7|   7359.55|2026-01-19 18:17:...|\n|    6000058|          Ro****y|     driver|         London|     12733.74|         2024|             5|    Indore-Kochi|      47.95|   2292.07|2026-01-19 18:17:...|\n|    5000001|          Ra****r|     driver|      Bangalore|       5000.0|         2024|             1|Bangalore-Mysore|      49.75|     900.0|2026-01-19 18:17:...|\n|    6000100|          Ra****r|     driver|         Mumbai|      15000.0|         2024|             1|     Mumbai-Pune|       30.0|    2700.0|2026-01-19 18:17:...|\n|    6000101|          Ra****r|     driver|         Mumbai|      22000.0|         2024|             1|      Mumbai-Goa|      36.67|    3960.0|2026-01-19 18:17:...|\n|    6000102|          Ra****r|     driver|         Mumbai|      45000.0|         2024|             2|    Mumbai-Delhi|      64.29|    8100.0|2026-01-19 18:17:...|\n|    6000200|          Da****a|     driver|         Mumbai|      12000.0|         2024|             3|    Mumbai-Surat|       60.0|    2160.0|2026-01-19 18:17:...|\n|    6000201|          Ra****n|     driver|         Mumbai|      18000.0|         2024|             3|   Mumbai-Nagpur|      51.43|    3240.0|2026-01-19 18:17:...|\n|    6000202|          Jo****a|     driver|         Mumbai|      55000.0|         2024|             3|    Mumbai-Nasik|      36.67|    9900.0|2026-01-19 18:17:...|\n|    5000001|          Ra****r|     driver|           NULL|       5000.0|         2024|             1|Bangalore-Mysore|      49.75|     900.0|2026-01-19 18:17:...|\n+-----------+-----------------+-----------+---------------+-------------+-------------+--------------+----------------+-----------+----------+--------------------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null},{"name":"top3","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"rank","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"lag_df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"prev_shipment_days","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"cube_df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"total_cost","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":null,"sqlProps":null},"workflows":[],"startTime":1768848097832,"submitTime":1768848074176,"finishTime":1768848115140,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",2461]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"4f8b0840-3442-4772-b3fe-4bb66dd7ea82"}],"dashboards":[],"guid":"455c7252-2219-4a87-9117-3712d98668e4","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":6358089889637120,"dataframes":["_sqldf"]}},"reposExportFormat":"JUPYTER","environmentMetadata":{"client":"4","base_environment":""},"computePreferences":null,"inputWidgetPreferences":null,"environmentSerializationPreferences":null}