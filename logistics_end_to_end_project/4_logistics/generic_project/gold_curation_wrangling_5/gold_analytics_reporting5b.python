{"version":"NotebookV1","origId":4136916387898510,"name":"gold_analytics_reporting5b","language":"python","commands":[{"version":"CommandV1","origId":4921811840474329,"guid":"20cbc9d0-3b8c-4ffb-8eff-854d557616a6","subtype":"script","commandType":"auto","position":1.0555555555555556,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Collecting word2number\n  Downloading word2number-1.1.zip (9.7 kB)\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nBuilding wheels for collected packages: word2number\n  Building wheel for word2number (setup.py): started\n  Building wheel for word2number (setup.py): finished with status 'done'\n  Created wheel for word2number: filename=word2number-1.1-py3-none-any.whl size=5568 sha256=57a6475aa990899f44b791f3e46e9a69d8685e8bbf0804fd47a5820891775119\n  Stored in directory: /home/spark-a39b884a-1c2b-4458-a1b9-5d/.cache/pip/wheels/5b/79/fb/d25928e599c7e11fe4e00d32048cd74933f34a74c633d2aea6\nSuccessfully built word2number\nInstalling collected packages: word2number\nSuccessfully installed word2number-1.1\n\u001B[43mNote: you may need to restart the kernel using %restart_python or dbutils.library.restartPython() to use updated packages.\u001B[0m\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848307810,"submitTime":0,"finishTime":1768848322215,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",888]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"091c523a-36d9-4d3e-afb9-fb90e63708f3"},{"version":"CommandV1","origId":4921811840474330,"guid":"7f93caf6-f8e5-4b08-a327-b51ed9ab188b","subtype":"script","commandType":"auto","position":1.1666666666666665,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848322323,"submitTime":0,"finishTime":1768848323214,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"906a486e-d5db-4ded-85b9-fe7a51e3d0b2"},{"version":"CommandV1","origId":4921811840474331,"guid":"8fcb1676-61b2-4a17-b97b-a316eb10d11b","subtype":"script","commandType":"auto","position":1.2777777777777777,"command":"","commandVersion":104,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848323257,"submitTime":0,"finishTime":1768848323521,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"ca134f5d-35c9-419f-8d8b-7fa1e19c3509"},{"version":"CommandV1","origId":4921811840474332,"guid":"aa67da2b-2fa5-47d7-90b1-c004381d154d","subtype":"script","commandType":"auto","position":1.3888888888888888,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848323554,"submitTime":0,"finishTime":1768848323738,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"4c42bf4a-cd7e-4685-aca7-a5d7b171f822"},{"version":"CommandV1","origId":4921811840474333,"guid":"fb626d4d-5620-498f-b624-404252b2b12e","subtype":"script","commandType":"auto","position":1.5,"command":"","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848323770,"submitTime":0,"finishTime":1768848324020,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"342ddd87-0e33-4fb8-af94-49a5efaaddc7"},{"version":"CommandV1","origId":4921811840474334,"guid":"a1886c64-f19d-4678-9fc1-49d906cdef0e","subtype":"script","commandType":"auto","position":1.6111111111111112,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848324049,"submitTime":0,"finishTime":1768848324217,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"6c15ae68-11f5-4ff6-a474-ea9358fa5dd2"},{"version":"CommandV1","origId":4921811840474335,"guid":"d7be16f9-08dc-4089-9cbd-89822139a470","subtype":"script","commandType":"auto","position":1.7222222222222223,"command":"","commandVersion":0,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848324244,"submitTime":0,"finishTime":1768848324426,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"36ec6b70-4d7e-4ffc-a105-3a044815366f"},{"version":"CommandV1","origId":4921811840474336,"guid":"06aad33b-3aa0-4a96-9386-189ffd531617","subtype":"script","commandType":"auto","position":1.8333333333333333,"command":"","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848324469,"submitTime":0,"finishTime":1768848324634,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["88685f43-96eb-4869-abef-ecc9c4161b19"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"a8571e16-3f59-4f75-80d9-7c1076b4a14c"},{"version":"CommandV1","origId":6358089889637124,"guid":"88685f43-96eb-4869-abef-ecc9c4161b19","subtype":"command","commandType":"auto","position":0.9444444444444444,"command":"%run /Workspace/Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/general_conf_utils_1_2/util_functions2","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"Notebook not found: util_functions2. Notebooks can be specified via a relative path (./Notebook or ../folder/Notebook) or via an absolute path (/Abs/Path/to/Notebook). Make sure you are specifying the path correctly.\n\nStacktrace:\n  /Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/bronze_ingest3: python","errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848307810,"submitTime":1768848301177,"finishTime":1768848324634,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"82dde024-3609-4162-9207-ddfafef48a0f"},{"version":"CommandV1","origId":6172445262621892,"guid":"8651a818-16b4-4c04-8f15-ff4a4d5b4e36","subtype":"command","commandType":"auto","position":0.9074074074074073,"command":"dbutils.widgets.text(\"catalog\",\"\")\nCATALOG=dbutils.widgets.get(\"catalog\").strip()\ndbutils.widgets.text(\"schema\",\"\")\nSCHEMA=dbutils.widgets.get(\"schema\").strip()","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"0fac35dc-94d1-4eac-b31c-50d3fd7cbb7a"},{"version":"CommandV1","origId":6172445262621893,"guid":"9abc473d-649e-46fc-a861-b260d30d2969","subtype":"command","commandType":"auto","position":0.9259259259259258,"command":"%python\nimport json\n\nconfig_nb_output = dbutils.notebook.run(\n    \"/Workspace/Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/general_conf_utils_1_2/configs_path1\",\n    120,{\"catalog\": CATALOG,\"schema\": SCHEMA})\n\nconfig_dict = json.loads(config_nb_output)\n\nCATALOG = config_dict[\"CATALOG\"]\nSCHEMA = config_dict[\"SCHEMA\"]\nSRC=config_dict[\"SRC\"]\nBRONZE = config_dict[\"BRONZE\"]\nSILVER = config_dict[\"SILVER\"]\nGOLD = config_dict[\"GOLD\"]\nSILVERDB = config_dict[\"SILVERDB\"]\nGOLDDB = config_dict[\"GOLDDB\"]","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"One of the commands could not be parsed","errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768746808320,"submitTime":1768746803774,"finishTime":1768746845803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"151de5fd-97f0-46c4-8dcd-a4a0ac23db3c"},{"version":"CommandV1","origId":4136916387898515,"guid":"fa638f26-d73c-43c0-a2a5-91b3d4f20e4b","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.window import Window\n\ndf = spark.read.format(\"delta\").load(f\"{GOLD}/core_curated\")\ndf.show()\n# TOP 3 DRIVERS BY COST PER HUB\nw = Window.partitionBy(\"origin_hub_city\") \\\n          .orderBy(F.col(\"shipment_cost\").desc())\n\ntop3 = df.withColumn(\"rank\", F.dense_rank().over(w)) \\\n         .filter(\"rank <= 3\")\n\n# LEAD / LAG\nlag_df = df.withColumn(\n    \"prev_shipment_days\",\n    F.lag(\"shipment_year\").over(\n        Window.partitionBy(\"masked_staff_name\").orderBy(\"shipment_year\")\n    )\n)\n\n# CUBE AGGREGATION\ncube_df = df.cube(\"origin_hub_city\") \\\n    .agg(F.sum(\"shipment_cost\").alias(\"total_cost\"))\n\nwrite_file(top3,f\"{GOLD}/top3_drivers\")\nwrite_file(lag_df,f\"{GOLD}/prev_shipment_days\")\nwrite_file(cube_df,f\"{GOLD}/cube_costs\")","commandVersion":27,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+-----------+-----------------+-----------+---------------+-------------+-------------+--------------+----------------+-----------+----------+--------------------+\n|shipment_id|masked_staff_name|       role|origin_hub_city|shipment_cost|shipment_year|shipment_month|   route_segment|cost_per_kg|tax_amount| ingestion_timestamp|\n+-----------+-----------------+-----------+---------------+-------------+-------------+--------------+----------------+-----------+----------+--------------------+\n|    6000009|          Si****h|     driver|         Jaipur|     11496.88|         2024|             5|Indore-Hyderabad|      20.44|   2069.44|2026-01-19 18:17:...|\n|    6000043|          Mo****r|coordinator|        Newyork|      40886.4|         2024|             3|  Indore-Chennai|      154.7|   7359.55|2026-01-19 18:17:...|\n|    6000058|          Ro****y|     driver|         London|     12733.74|         2024|             5|    Indore-Kochi|      47.95|   2292.07|2026-01-19 18:17:...|\n|    5000001|          Ra****r|     driver|      Bangalore|       5000.0|         2024|             1|Bangalore-Mysore|      49.75|     900.0|2026-01-19 18:17:...|\n|    6000100|          Ra****r|     driver|         Mumbai|      15000.0|         2024|             1|     Mumbai-Pune|       30.0|    2700.0|2026-01-19 18:17:...|\n|    6000101|          Ra****r|     driver|         Mumbai|      22000.0|         2024|             1|      Mumbai-Goa|      36.67|    3960.0|2026-01-19 18:17:...|\n|    6000102|          Ra****r|     driver|         Mumbai|      45000.0|         2024|             2|    Mumbai-Delhi|      64.29|    8100.0|2026-01-19 18:17:...|\n|    6000200|          Da****a|     driver|         Mumbai|      12000.0|         2024|             3|    Mumbai-Surat|       60.0|    2160.0|2026-01-19 18:17:...|\n|    6000201|          Ra****n|     driver|         Mumbai|      18000.0|         2024|             3|   Mumbai-Nagpur|      51.43|    3240.0|2026-01-19 18:17:...|\n|    6000202|          Jo****a|     driver|         Mumbai|      55000.0|         2024|             3|    Mumbai-Nasik|      36.67|    9900.0|2026-01-19 18:17:...|\n|    5000001|          Ra****r|     driver|           NULL|       5000.0|         2024|             1|Bangalore-Mysore|      49.75|     900.0|2026-01-19 18:17:...|\n+-----------+-----------------+-----------+---------------+-------------+-------------+--------------+----------------+-----------+----------+--------------------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null},{"name":"top3","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"rank","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"lag_df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"prev_shipment_days","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null},{"name":"cube_df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"total_cost","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":null,"sqlProps":null},"workflows":[],"startTime":1768848324698,"submitTime":1768848301366,"finishTime":1768848341958,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",2461]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"4f8b0840-3442-4772-b3fe-4bb66dd7ea82"},{"version":"CommandV1","origId":4136916387898526,"guid":"2fe39287-1f95-4fee-9280-6e3ed4b716a6","subtype":"command","commandType":"auto","position":2.0,"command":"analytics_df = df.orderBy(F.col(\"shipment_cost\").desc())\nwrite_file(analytics_df,f\"{GOLD}/analytics_ready\")","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"analytics_df","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768848341993,"submitTime":1768848301368,"finishTime":1768848344262,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"79e57644-04f0-456e-b632-eecf0e3b9128"}],"dashboards":[],"guid":"9718dae6-784c-476f-a979-eaaea40c6ba0","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":6358089889637123,"dataframes":["_sqldf"]}},"reposExportFormat":"JUPYTER","environmentMetadata":{"client":"4","base_environment":""},"computePreferences":null,"inputWidgetPreferences":null,"environmentSerializationPreferences":null}