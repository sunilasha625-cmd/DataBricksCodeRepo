{"version":"NotebookV1","origId":3312318445443462,"name":"gold_core_curated5a","language":"python","commands":[{"version":"CommandV1","origId":6172445262621894,"guid":"228447d7-a357-41c7-b90a-9867c64b8e57","subtype":"command","commandType":"auto","position":0.8611111111111112,"command":"dbutils.widgets.text(\"catalog\",\"\")\nCATALOG=dbutils.widgets.get(\"catalog\").strip()\ndbutils.widgets.text(\"schema\",\"\")\nSCHEMA=dbutils.widgets.get(\"schema\").strip()","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"dbd09edf-d49d-4507-a552-3bb18a2efbd8"},{"version":"CommandV1","origId":6172445262621895,"guid":"b17f193d-12dd-48ce-9d62-613652d9dc70","subtype":"command","commandType":"auto","position":0.888888888888889,"command":"%python\nimport json\n\nconfig_nb_output = dbutils.notebook.run(\n    \"/Workspace/Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/general_conf_utils_1_2/configs_path1\",\n    120,{\"catalog\": CATALOG,\"schema\": SCHEMA})\n\nconfig_dict = json.loads(config_nb_output)\n\nCATALOG = config_dict[\"CATALOG\"]\nSCHEMA = config_dict[\"SCHEMA\"]\nSRC=config_dict[\"SRC\"]\nBRONZE = config_dict[\"BRONZE\"]\nSILVER = config_dict[\"SILVER\"]\nGOLD = config_dict[\"GOLD\"]\nSILVERDB = config_dict[\"SILVERDB\"]\nGOLDDB = config_dict[\"GOLDDB\"]","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"One of the commands could not be parsed","errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768746808320,"submitTime":1768746803774,"finishTime":1768746845803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"7adfbcbc-6896-49b1-941f-fe8fbbb23954"},{"version":"CommandV1","origId":6358089889637127,"guid":"96f468ed-ed51-48ef-8a34-aabbc55543a0","subtype":"command","commandType":"auto","position":0.9166666666666667,"command":"%run /Workspace/Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/general_conf_utils_1_2/util_functions2","commandVersion":0,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"Notebook not found: util_functions2. Notebooks can be specified via a relative path (./Notebook or ../folder/Notebook) or via an absolute path (/Abs/Path/to/Notebook). Make sure you are specifying the path correctly.\n\nStacktrace:\n  /Users/infoblisstech@gmail.com/databricks-code-repo/4_logistics_usecase/generic_project/bronze_ingest3: python","errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847706833,"submitTime":1768847693089,"finishTime":1768847714737,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"9cd2af41-c1ec-4bfa-ac45-cce326af60d4"},{"version":"CommandV1","origId":6926205340395112,"guid":"1be5fb45-fc5d-42c1-9f2b-06bb924012e3","subtype":"command","commandType":"auto","position":1.0,"command":"staff = spark.read.format(\"delta\").load(f\"{SILVER}/staff\")\nshipments = spark.read.format(\"delta\").load(f\"{SILVER}/shipments\")\n\njoined = join_df(staff,shipments, \"inner\", \"shipment_id\")\n\ngold_core = joined.select(\n    \"shipment_id\",\n    mask_name(\"staff_full_name\").alias(\"masked_staff_name\"),\n    \"role\",\n    \"origin_hub_city\",\n    \"shipment_cost\",\n    \"shipment_year\",\n    \"shipment_month\",\n    \"route_segment\",\n    \"cost_per_kg\",\n    \"tax_amount\",\n    \"ingestion_timestamp\"\n)\n\nwrite_file(gold_core,f\"{GOLD}/core_curated\")\nwrite_table(gold_core,f\"{GOLDDB}.core_curated_tbl\", mode=\"overwrite\")\n","commandVersion":52,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"staff","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"hub_location","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"load_dt","nullable":true,"type":"timestamp"},{"metadata":{},"name":"staff_full_name","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"shipments","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"cargo_type","nullable":true,"type":"string"},{"metadata":{},"name":"destination_city","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"string"},{"metadata":{},"name":"payment_mode","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_date","nullable":true,"type":"date"},{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"shipment_status","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_weight_kg","nullable":true,"type":"double"},{"metadata":{},"name":"source_city","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"},{"metadata":{},"name":"domain","nullable":true,"type":"string"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"is_expedited","nullable":true,"type":"boolean"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_identifier","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"is_weekend","nullable":true,"type":"boolean"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"days_since_shipment","nullable":true,"type":"integer"},{"metadata":{},"name":"is_high_value","nullable":true,"type":"boolean"},{"metadata":{},"name":"order_prefix","nullable":true,"type":"string"},{"metadata":{},"name":"order_sequence","nullable":true,"type":"string"},{"metadata":{},"name":"ship_year","nullable":true,"type":"integer"},{"metadata":{},"name":"ship_month","nullable":true,"type":"integer"},{"metadata":{},"name":"ship_day","nullable":true,"type":"integer"},{"metadata":{},"name":"route_lane","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"joined","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"age","nullable":true,"type":"integer"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"hub_location","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"load_dt","nullable":true,"type":"timestamp"},{"metadata":{},"name":"staff_full_name","nullable":true,"type":"string"},{"metadata":{},"name":"cargo_type","nullable":true,"type":"string"},{"metadata":{},"name":"destination_city","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"string"},{"metadata":{},"name":"payment_mode","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_date","nullable":true,"type":"date"},{"metadata":{},"name":"shipment_status","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_weight_kg","nullable":true,"type":"double"},{"metadata":{},"name":"source_city","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_type","nullable":true,"type":"string"},{"metadata":{},"name":"domain","nullable":true,"type":"string"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"},{"metadata":{},"name":"is_expedited","nullable":true,"type":"boolean"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"vehicle_identifier","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"is_weekend","nullable":true,"type":"boolean"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"days_since_shipment","nullable":true,"type":"integer"},{"metadata":{},"name":"is_high_value","nullable":true,"type":"boolean"},{"metadata":{},"name":"order_prefix","nullable":true,"type":"string"},{"metadata":{},"name":"order_sequence","nullable":true,"type":"string"},{"metadata":{},"name":"ship_year","nullable":true,"type":"integer"},{"metadata":{},"name":"ship_month","nullable":true,"type":"integer"},{"metadata":{},"name":"ship_day","nullable":true,"type":"integer"},{"metadata":{},"name":"route_lane","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null},{"name":"gold_core","typeStr":"pyspark.sql.connect.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"shipment_id","nullable":true,"type":"long"},{"metadata":{},"name":"masked_staff_name","nullable":true,"type":"string"},{"metadata":{},"name":"role","nullable":true,"type":"string"},{"metadata":{},"name":"origin_hub_city","nullable":true,"type":"string"},{"metadata":{},"name":"shipment_cost","nullable":true,"type":"double"},{"metadata":{},"name":"shipment_year","nullable":true,"type":"integer"},{"metadata":{},"name":"shipment_month","nullable":true,"type":"integer"},{"metadata":{},"name":"route_segment","nullable":true,"type":"string"},{"metadata":{},"name":"cost_per_kg","nullable":true,"type":"double"},{"metadata":{},"name":"tax_amount","nullable":true,"type":"double"},{"metadata":{},"name":"ingestion_timestamp","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":{"type":"baseError","stackFrames":["com.databricks.backend.common.rpc.CommandSkippedException","\tat com.databricks.spark.chauffeur.SequenceExecutionState.$anonfun$cancel$3(SequenceExecutionState.scala:141)","\tat com.databricks.spark.chauffeur.SequenceExecutionState.$anonfun$cancel$3$adapted(SequenceExecutionState.scala:136)","\tat scala.collection.immutable.Range.foreach(Range.scala:192)","\tat com.databricks.spark.chauffeur.SequenceExecutionState.cancel(SequenceExecutionState.scala:136)","\tat com.databricks.spark.chauffeur.ExecContextState.cancelRunningSequence(ExecContextState.scala:721)","\tat com.databricks.spark.chauffeur.ExecContextState.$anonfun$cancel$1(ExecContextState.scala:441)","\tat scala.Option.getOrElse(Option.scala:201)","\tat com.databricks.spark.chauffeur.ExecContextState.cancel(ExecContextState.scala:441)","\tat com.databricks.spark.chauffeur.ExecutionContextManagerV1.cancelExecution(ExecutionContextManagerV1.scala:486)","\tat com.databricks.spark.chauffeur.ChauffeurState.$anonfun$process$1(ChauffeurState.scala:768)","\tat com.databricks.logging.UsageLogging.$anonfun$recordOperation$1(UsageLogging.scala:512)","\tat com.databricks.logging.UsageLogging.executeThunkAndCaptureResultTags$1(UsageLogging.scala:632)","\tat com.databricks.logging.UsageLogging.$anonfun$recordOperationWithResultTags$5(UsageLogging.scala:659)","\tat com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:117)","\tat com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:348)","\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)","\tat com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:344)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:115)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:112)","\tat com.databricks.spark.chauffeur.ChauffeurState.withAttributionContext(ChauffeurState.scala:80)","\tat com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:172)","\tat com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:153)","\tat com.databricks.spark.chauffeur.ChauffeurState.withAttributionTags(ChauffeurState.scala:80)","\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags(UsageLogging.scala:627)","\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags$(UsageLogging.scala:521)","\tat com.databricks.spark.chauffeur.ChauffeurState.recordOperationWithResultTags(ChauffeurState.scala:80)","\tat com.databricks.logging.UsageLogging.recordOperation(UsageLogging.scala:513)","\tat com.databricks.logging.UsageLogging.recordOperation$(UsageLogging.scala:477)","\tat com.databricks.spark.chauffeur.ChauffeurState.recordOperation(ChauffeurState.scala:80)","\tat com.databricks.spark.chauffeur.ChauffeurState.process(ChauffeurState.scala:740)","\tat com.databricks.spark.chauffeur.Chauffeur.handleDriverRequest$1(Chauffeur.scala:943)","\tat com.databricks.spark.chauffeur.Chauffeur.$anonfun$handleDriverRequests$2(Chauffeur.scala:970)","\tat com.databricks.logging.UsageLogging.executeThunkAndCaptureResultTags$1(UsageLogging.scala:632)","\tat com.databricks.logging.UsageLogging.$anonfun$recordOperationWithResultTags$5(UsageLogging.scala:659)","\tat com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:117)","\tat com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:348)","\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)","\tat com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:344)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:115)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:112)","\tat com.databricks.spark.chauffeur.Chauffeur.withAttributionContext(Chauffeur.scala:167)","\tat com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:172)","\tat com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:153)","\tat com.databricks.spark.chauffeur.Chauffeur.withAttributionTags(Chauffeur.scala:167)","\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags(UsageLogging.scala:627)","\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags$(UsageLogging.scala:521)","\tat com.databricks.spark.chauffeur.Chauffeur.recordOperationWithResultTags(Chauffeur.scala:167)","\tat com.databricks.spark.chauffeur.Chauffeur.handleDriverRequestWithUsageLogging$1(Chauffeur.scala:969)","\tat com.databricks.spark.chauffeur.Chauffeur.handleDriverRequests(Chauffeur.scala:1020)","\tat com.databricks.spark.chauffeur.Chauffeur$$anon$1$$anonfun$com$databricks$spark$chauffeur$Chauffeur$$nestedInanon$$receiveInternal$1.applyOrElse(Chauffeur.scala:828)","\tat com.databricks.spark.chauffeur.Chauffeur$$anon$1$$anonfun$com$databricks$spark$chauffeur$Chauffeur$$nestedInanon$$receiveInternal$1.applyOrElse(Chauffeur.scala:730)","\tat scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:35)","\tat com.databricks.spark.chauffeur.Chauffeur$$anon$1$$anonfun$receive$1.applyOrElse(Chauffeur.scala:726)","\tat com.databricks.spark.chauffeur.Chauffeur$$anon$1$$anonfun$receive$1.applyOrElse(Chauffeur.scala:721)","\tat com.databricks.rpc.ServerBackend.$anonfun$internalReceive0$2(ServerBackend.scala:178)","\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:204)","\tat com.databricks.rpc.ServerBackend$$anonfun$commonReceive$1.applyOrElse(ServerBackend.scala:204)","\tat com.databricks.rpc.ServerBackend.internalReceive0(ServerBackend.scala:175)","\tat com.databricks.rpc.ServerBackend.$anonfun$internalReceive$1(ServerBackend.scala:165)","\tat com.databricks.logging.UsageLogging.$anonfun$recordOperation$1(UsageLogging.scala:512)","\tat com.databricks.logging.UsageLogging.executeThunkAndCaptureResultTags$1(UsageLogging.scala:632)","\tat com.databricks.logging.UsageLogging.$anonfun$recordOperationWithResultTags$5(UsageLogging.scala:659)","\tat com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:117)","\tat com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:348)","\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)","\tat com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:344)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:115)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:112)","\tat com.databricks.rpc.ServerBackend.withAttributionContext(ServerBackend.scala:22)","\tat com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:172)","\tat com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:153)","\tat com.databricks.rpc.ServerBackend.withAttributionTags(ServerBackend.scala:22)","\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags(UsageLogging.scala:627)","\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags$(UsageLogging.scala:521)","\tat com.databricks.rpc.ServerBackend.recordOperationWithResultTags(ServerBackend.scala:22)","\tat com.databricks.logging.UsageLogging.recordOperation(UsageLogging.scala:513)","\tat com.databricks.logging.UsageLogging.recordOperation$(UsageLogging.scala:477)","\tat com.databricks.rpc.ServerBackend.recordOperation(ServerBackend.scala:22)","\tat com.databricks.rpc.ServerBackend.executeWithLogging$1(ServerBackend.scala:147)","\tat com.databricks.rpc.ServerBackend.internalReceive(ServerBackend.scala:165)","\tat com.databricks.rpc.JettyServer$RequestManager.handleRPC(JettyServer.scala:997)","\tat com.databricks.rpc.JettyServer$RequestManager.handleRequestAndRespond(JettyServer.scala:917)","\tat com.databricks.rpc.JettyServer$RequestManager.$anonfun$handleHttp$5(JettyServer.scala:557)","\tat com.databricks.rpc.JettyServer$RequestManager.$anonfun$handleHttp$5$adapted(JettyServer.scala:522)","\tat com.databricks.logging.activity.ActivityContextFactory$.$anonfun$withActivityInternal$12(ActivityContextFactory.scala:1132)","\tat com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:117)","\tat com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:348)","\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)","\tat com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:344)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:115)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:112)","\tat com.databricks.logging.activity.ActivityContextFactory$.withAttributionContext(ActivityContextFactory.scala:68)","\tat com.databricks.logging.activity.ActivityContextFactory$.$anonfun$withActivityInternal$2(ActivityContextFactory.scala:1132)","\tat com.databricks.context.integrity.IntegrityCheckContext$ThreadLocalStorage$.withValue(IntegrityCheckContext.scala:73)","\tat com.databricks.logging.activity.ActivityContextFactory$.withActivityInternal(ActivityContextFactory.scala:1094)","\tat com.databricks.logging.activity.ActivityContextFactory$.withActivityInternal(ActivityContextFactory.scala:1075)","\tat com.databricks.logging.activity.ActivityContextFactory$.$anonfun$withServiceRequestActivity$41(ActivityContextFactory.scala:437)","\tat com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:117)","\tat com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:348)","\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)","\tat com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:344)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:115)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:112)","\tat com.databricks.logging.activity.ActivityContextFactory$.withAttributionContext(ActivityContextFactory.scala:68)","\tat com.databricks.logging.activity.ActivityContextFactory$.withServiceRequestActivity(ActivityContextFactory.scala:437)","\tat com.databricks.rpc.JettyServer$RequestManager.handleHttp(JettyServer.scala:522)","\tat com.databricks.rpc.JettyServer$RequestManager.doPost(JettyServer.scala:417)","\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:665)","\tat com.databricks.rpc.HttpServletWithPatch.service(HttpServletWithPatch.scala:33)","\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:750)","\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)","\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:554)","\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:190)","\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)","\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)","\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)","\tat org.eclipse.jetty.server.Server.handle(Server.java:516)","\tat org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)","\tat org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)","\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)","\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)","\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)","\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)","\tat org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:555)","\tat org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:410)","\tat org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:164)","\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)","\tat org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)","\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)","\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)","\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)","\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)","\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)","\tat com.databricks.rpc.InstrumentedQueuedThreadPool$$anon$1.$anonfun$run$2(InstrumentedQueuedThreadPool.scala:111)","\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)","\tat com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:117)","\tat com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:348)","\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)","\tat com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:344)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:115)","\tat com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:112)","\tat com.databricks.rpc.InstrumentedQueuedThreadPool.withAttributionContext(InstrumentedQueuedThreadPool.scala:46)","\tat com.databricks.rpc.InstrumentedQueuedThreadPool$$anon$1.$anonfun$run$1(InstrumentedQueuedThreadPool.scala:111)","\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)","\tat com.databricks.instrumentation.QueuedThreadPoolInstrumenter.trackActiveThreads(QueuedThreadPoolInstrumenter.scala:132)","\tat com.databricks.instrumentation.QueuedThreadPoolInstrumenter.trackActiveThreads$(QueuedThreadPoolInstrumenter.scala:129)","\tat com.databricks.rpc.InstrumentedQueuedThreadPool.trackActiveThreads(InstrumentedQueuedThreadPool.scala:46)","\tat com.databricks.rpc.InstrumentedQueuedThreadPool$$anon$1.run(InstrumentedQueuedThreadPool.scala:93)","\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)","\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)","\tat java.base/java.lang.Thread.run(Thread.java:840)"],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{},"jupyterProps":null,"sqlProps":null},"workflows":[],"startTime":1768847714767,"submitTime":1768847693277,"finishTime":1768847731750,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"6f79117e-5c52-4ea8-a834-b9066bbcffef"},{"version":"CommandV1","origId":4921811840474305,"guid":"b947a28d-3bac-45b6-bafa-d94a8029e36e","subtype":"script","commandType":"auto","position":1.027777777777778,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Requirement already satisfied: word2number in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f9887c3c-1ec8-4c69-b351-0b7f53801278/lib/python3.12/site-packages (1.1)\n\u001B[43mNote: you may need to restart the kernel using %restart_python or dbutils.library.restartPython() to use updated packages.\u001B[0m\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847706833,"submitTime":0,"finishTime":1768847712901,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",293]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"091c523a-36d9-4d3e-afb9-fb90e63708f3"},{"version":"CommandV1","origId":4921811840474306,"guid":"f67ca62e-49dd-4af1-83d4-798f22b4f9cb","subtype":"script","commandType":"auto","position":1.1388888888888888,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847712987,"submitTime":0,"finishTime":1768847713394,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"906a486e-d5db-4ded-85b9-fe7a51e3d0b2"},{"version":"CommandV1","origId":4921811840474307,"guid":"5c549e4e-be3d-408b-918e-6e97565a17e0","subtype":"script","commandType":"auto","position":1.25,"command":"","commandVersion":104,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847713448,"submitTime":0,"finishTime":1768847713695,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"ca134f5d-35c9-419f-8d8b-7fa1e19c3509"},{"version":"CommandV1","origId":4921811840474308,"guid":"e57ace04-1ce3-4caf-9801-947679d262c5","subtype":"script","commandType":"auto","position":1.3611111111111112,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847713725,"submitTime":0,"finishTime":1768847713904,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"4c42bf4a-cd7e-4685-aca7-a5d7b171f822"},{"version":"CommandV1","origId":4921811840474309,"guid":"22f3ddf0-1523-4b55-aeef-ebd962465114","subtype":"script","commandType":"auto","position":1.4722222222222223,"command":"","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847713932,"submitTime":0,"finishTime":1768847714108,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"342ddd87-0e33-4fb8-af94-49a5efaaddc7"},{"version":"CommandV1","origId":4921811840474310,"guid":"d14257f9-9ac4-4b0d-8d74-4c32844be439","subtype":"script","commandType":"auto","position":1.5833333333333335,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847714143,"submitTime":0,"finishTime":1768847714351,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"6c15ae68-11f5-4ff6-a474-ea9358fa5dd2"},{"version":"CommandV1","origId":4921811840474311,"guid":"8f317a2f-275d-426d-90b7-81ba5d52e550","subtype":"script","commandType":"auto","position":1.6944444444444446,"command":"","commandVersion":0,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847714376,"submitTime":0,"finishTime":1768847714532,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"36ec6b70-4d7e-4ffc-a105-3a044815366f"},{"version":"CommandV1","origId":4921811840474312,"guid":"d35dd6f5-3a35-4bee-9a38-781c106e0a41","subtype":"script","commandType":"auto","position":1.8055555555555556,"command":"","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1768847714581,"submitTime":0,"finishTime":1768847714737,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["96f468ed-ed51-48ef-8a34-aabbc55543a0"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"latestAssumeRoleInfo":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"a8571e16-3f59-4f75-80d9-7c1076b4a14c"}],"dashboards":[],"guid":"c3022c80-6046-49b5-a5c4-902cabe2f883","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":6358089889637126,"dataframes":["_sqldf"]}},"reposExportFormat":"JUPYTER","environmentMetadata":{"client":"4","base_environment":""},"computePreferences":null,"inputWidgetPreferences":null,"environmentSerializationPreferences":null}